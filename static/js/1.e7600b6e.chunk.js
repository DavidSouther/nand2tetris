"use strict";(self.webpackChunkcomputron5k=self.webpackChunkcomputron5k||[]).push([[1],{9001:function(t,n,e){e.r(n),e.d(n,{Chip:function(){return oi},default:function(){return ci}});var i=e(5671),r=e(3144),a=e(136),s=e(9388),u=e(4165),o=e(5861),c=e(9439),l=e(173),h=e(2791),d=e(1413),v=e(3433),f=e(2440),p=e(8429),m=e(184);function g(t){return{pin:t,bits:(0,p.w)(0,t.width).map((function(n){return[n,t.voltage(n)]})).reverse()}}function b(t){return(0,v.Z)(t.entries()).map(g)}var Z=function(t){var n=(0,m.jsx)(y,(0,d.Z)({header:f.ag._("{0, plural, one {Input pin} other {Input pins}}",{0:t.ins.pins.length})},t.ins)),e=(0,m.jsx)(y,(0,d.Z)({header:f.ag._("{0, plural, one {Output pin} other {Output pins}}",{0:t.outs.pins.length})},t.outs)),i=(0,m.jsx)(y,(0,d.Z)({header:f.ag._("{0, plural, one {Internal pin} other {Internal pins}}",{0:t.internal.pins.length})},t.internal));return(0,m.jsx)("table",{className:"pinout",children:(0,m.jsxs)("tbody",{children:[n,e,i]})})},y=function(t){return(0,m.jsxs)(m.Fragment,{children:[t.pins.length>0&&(0,m.jsx)("tr",{children:(0,m.jsx)("th",{colSpan:2,children:t.header})}),(0,v.Z)(t.pins).map((function(n){return(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:n.pin.name}),(0,m.jsx)("td",{children:(0,m.jsx)(k,{pin:n,toggle:t.toggle})})]},n.pin.name)}))]})},k=function(t){var n=t.pin,e=t.toggle;return(0,m.jsx)("fieldset",{role:"group",style:{width:"".concat(n.bits.length,"rem")},children:n.bits.map((function(t){var i=(0,c.Z)(t,2),r=i[0],a=i[1];return(0,m.jsx)("button",{onClick:function(){return null===e||void 0===e?void 0:e(n.pin,r)},disabled:void 0===e,"data-testid":"pin-".concat(r),children:a},r)}))})},x=e(7762),w=e(8349),j=e(4097),C=e(7006),S=e(6509),A=f.ag._("Unknown parse error"),M={Base:C.Z.grammar('Base {\n  Root = (Name | Number)*\n\n  At = at\n  Bang = bang\n  Bar = bar\n  CloseAngle = closeAngle\n  CloseBrace = closeBrace\n  CloseParen = closeParen\n  CloseSquare = closeSquare\n  Comma = comma\n  Dot = dot\n  DoubleQuote = doubleQuote\n  Equal = equal\n  OpenAngle = openAngle\n  OpenBrace = openBrace\n  OpenParen = openParen\n  OpenSquare = openSquare\n  Percent = percent\n  Semi = semi\n  Underscore = underscore\n\n  at = "@"\n  bang = "!"\n  bar = "|"\n  closeAngle = ">"\n  closeBrace = "}"\n  closeParen = ")"\n  closeSquare = "]"\n  comma = ","\n  dot = "."\n  doubleQuote = "\\""\n  equal = "="\n  minus = "-"\n  newline = "\\r"? "\\n"\n  openAngle = "<"\n  openBrace = "{"\n  openParen = "("\n  openSquare = "["\n  percent = "%"\n  semi = ";"\n  underscore = "_"\n\n  True = true\n  False = false\n  true = "true"\n  false = "false"\n\n  Name = identifier\n  identifier = (letter|underscore) (alnum|underscore)*\n\n  Number = hexNumber | decNumber | binNumber\n  binNumber = ("%B") ("0"|"1")+\n  hexNumber = ("%X") hexDigit+\n  decNumber = ("%D")? (wholeDec | realDec)\n  wholeDec = minus? digit+\n  realDec = minus? digit* "." digit+\n\n  String = DoubleQuote (~doubleQuote any)* doubleQuote\n  \n  spaces := (lineComment | comment | space)*\n  commentStart = "/*"\n  commentEnd = "*/"\n  comment = commentStart (~commentEnd any)* commentEnd\n  lineCommentStart = "//"\n  lineComment = lineCommentStart (~"\\n" any)* "\\n"\n\n  List<elem, sep> = NonemptyListOf<elem, sep> sep?\n  EmptyList<elem, sep> = EmptyList<elem, sep> sep?\n}')},P=M.Base.createSemantics();function V(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){return t.root};return function(i){try{var r,a,s=t.match(i);if(s.succeeded()){var u=n(s),o=e(u);return(0,w.Ok)(o)}return(0,w.UG)({message:null!==(r=s.message)&&void 0!==r?r:A,shortMessage:null!==(a=s.shortMessage)&&void 0!==a?a:A})}catch(c){return(0,w.UG)(c)}}}P.extendOperation("asIteration",{List:function(t,n){return t.asIteration()}}),P.addAttribute("value",{decNumber:function(t,n){return(0,S.o5)(n.sourceString)},wholeDec:function(t,n){return(0,S.o5)(n.sourceString)},binNumber:function(t,n){return(0,S.C$)(n.sourceString)},hexNumber:function(t,n){return(0,S.Af)(n.sourceString)},Number:function(t){return t.value}}),P.addAttribute("name",{identifier:function(t,n){return this.sourceString},Name:function(t){var n;return null===(n=this.child(0))||void 0===n?void 0:n.name}}),P.addAttribute("String",{String:function(t,n,e){return n.sourceString}});var D='Hdl <: Base{\n  Root := Chip\n  Chip = "CHIP" Name OpenBrace ChipBody CloseBrace\n  ChipBody = InList? OutList? PartList ClockedList?\n  InList = "IN" PinList Semi\n  OutList = "OUT" PinList Semi\n  PartList = BuiltinPart | Parts\n  PinList = List<PinDecl, Comma>\n  PinDecl = Name PinWidth?\n  PinWidth = OpenSquare decNumber CloseSquare\n  BuiltinPart = "BUILTIN" Semi\n  Parts = "PARTS:" Part*\n  Part = Name "(" Wires ")" Semi\n  Wires = List<Wire, Comma>\n  Wire = WireSide Equal (WireSide | True | False) \n  WireSide = Name SubBus? \n  SubBus = OpenSquare decNumber subBusRest? CloseSquare\n  subBusRest = ".." decNumber\n  ClockedList = "CLOCKED" SimplePinList Semi\n  SimplePinList = List<Name, Comma>\n}',O=C.Z.grammar(D,M),N=O.extendSemantics(P);N.addAttribute("SubBus",{SubBus:function(t,n,e,i){var r,a,s,u=n.value;return{start:u,end:null!==(r=null===(a=e.child(0))||void 0===a||null===(s=a.child(1))||void 0===s?void 0:s.value)&&void 0!==r?r:u}}}),N.addAttribute("WireSide",{WireSide:function(t,n){var e,i,r=t.name,a=null!==(e=null===(i=n.child(0))||void 0===i?void 0:i.SubBus)&&void 0!==e?e:{start:void 0,end:void 0};return{pin:r,start:a.start,end:a.end}}}),N.addAttribute("Wire",{Wire:function(t,n,e){var i=e.isTerminal()?{pin:e.sourceString}:e.WireSide;return{lhs:t.WireSide,rhs:i}}}),N.addAttribute("Wires",{Wires:function(t){return t.asIteration().children.map((function(t){return t.Wire}))}}),N.addAttribute("Part",{Part:function(t,n,e,i,r){return{name:t.name,wires:e.Wires}}}),N.addAttribute("Parts",{Parts:function(t,n){return n.children.map((function(t){return t.Part}))},BuiltinPart:function(t,n){return"BUILTIN"}}),N.addAttribute("PartList",{PartList:function(t){return t.Parts}}),N.addAttribute("Clocked",{ClockedList:function(t,n,e){var i;return null!==(i=n.asIteration().children.map((function(t){return t.sourceString})))&&void 0!==i?i:[]}}),N.addAttribute("PinDecl",{PinDecl:function(t,n){var e,i,r;return{pin:t.name,width:null!==(e=null===(i=n.child(0))||void 0===i||null===(r=i.child(1))||void 0===r?void 0:r.value)&&void 0!==e?e:1}}}),N.addAttribute("PinList",{PinList:function(t){return t.asIteration().children.map((function(t){return t.PinDecl}))}}),N.addAttribute("Chip",{Chip:function(t,n,e,i,r){var a,s,u,o,c,l,h,d;return{name:n.name,ins:null!==(a=null===(s=i.child(0).child(0))||void 0===s||null===(u=s.child(1))||void 0===u?void 0:u.PinList)&&void 0!==a?a:[],outs:null!==(o=null===(c=i.child(1).child(0))||void 0===c||null===(l=c.child(1))||void 0===l?void 0:l.PinList)&&void 0!==o?o:[],parts:null!==(h=i.child(2).PartList)&&void 0!==h?h:[],clocked:null===(d=i.child(3).child(0))||void 0===d?void 0:d.Clocked}}}),N.addAttribute("Root",{Root:function(t){var n;return null===(n=t.child(0))||void 0===n?void 0:n.Chip}});var R={parser:O,grammar:D,semantics:N,parse:V(O,N,(function(t){return t.Chip}))},F='Tst <: Base {\n  Root := Tst\n  Tst = (TstStatement | TstRepeat)+\n\n  TstRepeat = Repeat Number OpenBrace TstStatement+ CloseBrace\n  TstStatement = List<TstOperation, ","> (Semi | Bang)\n\n  TstOperation =\n    | TstOutputListOperation\n    | TstEvalOperation\n    | TstSetOperation\n    | TstOutputOperation\n    | TstEchoOperation\n    | TstClearEchoOperation\n    | TstLoadROMOperation\n\n  TstLoadROMOperation = ROM32K Load FileName\n  TstOutputListOperation = "output-list" OutputFormat+\n  OutputFormat = Name Index? percent FormatStyle wholeDec dot wholeDec dot wholeDec\n  TstSetOperation = Set Name Index? Number\n  Index = OpenSquare wholeDec? CloseSquare\n  TstEvalOperation = Eval | Tick | Tock\n  TstOutputOperation = Output\n  TstEchoOperation = Echo String\n  TstClearEchoOperation = ClearEcho\n\n  FileName = Name dot identifier \n\n  Set = "set"\n  Eval = "eval"\n  Tick = "tick"\n  Tock = "tock"\n  Echo = "echo"\n  Repeat = "repeat"\n  ClearEcho = "clear-echo"\n  Output = "output"\n  OutputList = "output-list"\n  FormatStyle = "B"|"D"|"S"|"X"\n  ROM32K = "ROM32K"\n  Load = "load"\n}',L=C.Z.grammar(F,M),E=L.extendSemantics(P);E.extendAttribute("value",{Index:function(t,n,e){var i,r;return null!==(i=null===n||void 0===n||null===(r=n.child(0))||void 0===r?void 0:r.value)&&void 0!==i?i:-1}}),E.extendAttribute("name",{FileName:function(t,n,e){return"".concat(t.name,".").concat(e.name)}}),E.addAttribute("index",{Index:function(t,n,e){var i,r;return null!==(i=null===(r=n.child(0))||void 0===r?void 0:r.value)&&void 0!==i?i:0}}),E.addAttribute("format",{OutputFormat:function(t,n,e,i,r,a,s,u,o){var c,l,h=t.name,d=i.sourceString,v=r.value,f=s.value,p=o.value;return{id:h,builtin:void 0!==(null===n||void 0===n?void 0:n.child(0)),address:null!==(c=null===n||void 0===n||null===(l=n.child(0))||void 0===l?void 0:l.value)&&void 0!==c?c:-1,style:d,width:f,lpad:v,rpad:p}}}),E.addAttribute("operation",{TstEvalOperation:function(t){function n(n){return t.apply(this,arguments)}return n.toString=function(){return t.toString()},n}((function(t){return{op:t.sourceString}})),TstOutputOperation:function(t){return{op:"output"}},TstOutputListOperation:function(t,n){return{op:"output-list",spec:n.children.map((function(t){return t.format}))}},TstSetOperation:function(t){function n(n,e,i,r){return t.apply(this,arguments)}return n.toString=function(){return t.toString()},n}((function(t,n,e,i){var r,a,s={op:"set",id:n.name,value:i.value},u=null===(r=e.child(0))||void 0===r||null===(a=r.child(1))||void 0===a?void 0:a.child(0);return u&&(s.index=u.value),s})),TstEchoOperation:function(t,n){return{op:"echo",message:n.String}},TstClearEchoOperation:function(t){return{op:"clear-echo"}},TstLoadROMOperation:function(t,n,e){return{op:"load",file:e.name}}}),E.addAttribute("statement",{TstRepeat:function(t,n,e,i,r){var a=n.value;return{statements:i.children.map((function(t){return t.statement})),count:a}},TstStatement:function(t){function n(n,e){return t.apply(this,arguments)}return n.toString=function(){return t.toString()},n}((function(t,n){var e={ops:t.asIteration().children.map((function(t){return t.operation})),span:{start:this.source.startIdx,end:this.source.endIdx}};return"!"===n.sourceString&&(e.break=!0),e}))}),E.addAttribute("tst",{Tst:function(t){return{lines:t.children.map((function(t){return t.statement}))}}}),E.addAttribute("root",{Root:function(t){return t.tst}});var T,I,B={grammar:F,semantics:E,parser:L,parse:V(L,E)},_=e(7326),U=e(1752),W=e(1120),H=e(6274),J=e(9359),K=e(804),z=e(1020),G=e(9462),q=e(2358),$=function(){function t(){(0,i.Z)(this,t),this.level=Q,this.ticks=0,this.subject=new G.X({level:this.level,ticks:this.ticks}),this.$=this.subject,this.update=new q.x}return(0,r.Z)(t,[{key:"next",value:function(){this.subject.next({level:this.level,ticks:this.ticks}),this.update.next()}},{key:"reset",value:function(){this.level=Q,this.ticks=0,this.next()}},{key:"tick",value:function(){(0,z.hu)(this.level===Q,"Can only tick up from LOW"),this.level=X,this.next()}},{key:"tock",value:function(){(0,z.hu)(this.level===X,"Can only tock down from HIGH"),this.level=Q,this.ticks+=1,this.next()}},{key:"toggle",value:function(){this.level===X?this.tock():this.tick()}},{key:"eval",value:function(){this.tick(),this.tock()}},{key:"toString",value:function(){return"".concat(this.ticks).concat(this.level===X?"+":"")}}],[{key:"get",value:function(){return void 0===T&&(T=new t),T}}]),t}(),X=1,Q=0,Y=function(){function t(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;(0,i.Z)(this,t),this.name=n,this.width=e,this.state=void 0,this.next=[],this.state=(0,p.w)(0,this.width).map((function(){return Q}))}return(0,r.Z)(t,[{key:"ensureWidth",value:function(t){(0,z.hu)(t<=16,"Cannot widen past 16 to ".concat(t," bits")),this.width<t&&(this.width=t,this.state=[].concat((0,v.Z)(this.state),(0,v.Z)((0,p.w)(this.width,t).map((function(){return Q})))))}},{key:"connect",value:function(t){this.next.push(t),t.busVoltage=this.busVoltage}},{key:"pull",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,z.hu)(n>=0&&n<this.width,"Bit out of bounds: ".concat(this.name,"@").concat(n)),this.state[n]=t,this.next.forEach((function(e){return e.pull(t,n)}))}},{key:"voltage",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return(0,z.hu)(t>=0&&t<this.width),this.state[t]}},{key:"busVoltage",get:function(){var t=this;return(0,p.w)(0,this.width).reduce((function(n,e){return n|t.state[e]<<e}),0)},set:function(t){var n,e=this,i=(0,x.Z)((0,p.w)(0,this.width));try{for(i.s();!(n=i.n()).done;){var r=n.value;this.state[r]=(t&1<<r)>>r}}catch(a){i.e(a)}finally{i.f()}this.next.forEach((function(t){return t.busVoltage=e.busVoltage}))}},{key:"toggle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=this.voltage(t)===Q?X:Q;this.pull(n,t)}}]),t}(),tt=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(t,r){var a,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(0,i.Z)(this,e),(a=n.call(this,t.name)).bus=t,a.start=r,a.width=s,(0,z.hu)(r>=0&&r+s<=t.width,"Mismatched InSubBus dimensions on ".concat(t.name," (").concat(s," + ").concat(r," > ").concat(t.width,")")),a.connect(t),a}return(0,r.Z)(e,[{key:"pull",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,z.hu)(n>=0&&n<this.width),this.bus.pull(t,this.start+n)}},{key:"voltage",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return(0,z.hu)(t>=0&&t<this.width),this.bus.voltage(this.start+t)}},{key:"busVoltage",get:function(){return this.bus.busVoltage>>this.start&dt(this.width)},set:function(t){var n=this.bus.busVoltage&~dt(this.width+this.start),e=this.bus.busVoltage&dt(this.start),i=(t&dt(this.width))<<this.start;this.bus.busVoltage=n|i|e}},{key:"connect",value:function(t){(0,z.hu)(this.start+this.width<=t.width,"Mismatched InSubBus connection dimensions (From ".concat(t.name," to ").concat(this.name,")")),this.bus=t}}]),e}(Y),nt=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(t,r){var a,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(0,i.Z)(this,e),(a=n.call(this,t.name)).bus=t,a.start=r,a.width=s,(0,z.hu)(r>=0&&s<=t.width,"Mismatched OutSubBus dimensions"),a.connect(t),a}return(0,r.Z)(e,[{key:"busVoltage",get:function(){return this.bus.busVoltage&dt(this.width)},set:function(t){this.bus.busVoltage=(t&dt(this.width+this.start))>>this.start}},{key:"connect",value:function(t){(0,z.hu)(this.width<=t.width,"Mismatched OutSubBus connection dimensions"),this.bus=t}}]),e}(Y),et=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(t,r){var a;return(0,i.Z)(this,e),(a=n.call(this,t,16)).value=r,a}return(0,r.Z)(e,[{key:"pullHigh",value:function(){}},{key:"pullLow",value:function(){}},{key:"voltage",value:function(){return 1&this.busVoltage}},{key:"busVoltage",get:function(){return this.value},set:function(t){}}]),e}(Y),it=new et("true",65535),rt=new et("false",0);function at(t){var n,e=null===(n=t.match((0,K.Z)(/([a-zA-Z]+)(\[(\d+)\])?/,{pin:1,w:3})))||void 0===n?void 0:n.groups,i=e.pin,r=e.w;return{pin:i,width:r?Number(r):1}}I=Symbol.iterator;var st=function(){function t(){(0,i.Z)(this,t),this.map=new Map}return(0,r.Z)(t,[{key:"insert",value:function(t){var n=t.name;(0,z.hu)(!this.map.has(n),"Pins already has ".concat(n,"!")),this.map.set(n,t)}},{key:"emplace",value:function(t,n){if(this.has(t))return this.get(t);var e=new Y(t,n);return this.insert(e),e}},{key:"has",value:function(t){return this.map.has(t)}},{key:"get",value:function(t){return this.map.get(t)}},{key:"entries",value:function(){return this.map.values()}},{key:I,value:function(){return this.map[Symbol.iterator]()}}]),t}(),ut=0,ot=function(){function t(n,e,r){var a=this,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];(0,i.Z)(this,t),this.name=r,this.id=ut++,this.ins=new st,this.outs=new st,this.pins=new st,this.parts=new Set,this.clockedPins=void 0;var o,c=(0,x.Z)(n);try{for(c.s();!(o=c.n()).done;){var l=o.value,h=void 0!==l.pin?l:at(l),d=h.pin,v=h.width,f=void 0===v?1:v;this.ins.insert(new Y(d,f))}}catch(V){c.e(V)}finally{c.f()}var p,m=(0,x.Z)(e);try{for(m.s();!(p=m.n()).done;){var g=p.value,b=void 0!==g.pin?g:at(g),Z=b.pin,y=b.width,k=void 0===y?1:y;this.outs.insert(new Y(Z,k))}}catch(V){m.e(V)}finally{m.f()}var w,j=(0,x.Z)(s);try{for(j.s();!(w=j.n()).done;){var C=w.value,S=void 0!==C.pin?C:at(C),A=S.pin,M=S.width,P=void 0===M?1:M;this.pins.insert(new Y(A,P))}}catch(V){j.e(V)}finally{j.f()}this.clockedPins=new Set(u),$.get().$.subscribe((function(){return a.eval()}))}return(0,r.Z)(t,[{key:"clocked",get:function(){if(this.clockedPins.size>0)return!0;var t,n=(0,x.Z)(this.parts);try{for(n.s();!(t=n.n()).done;){if(t.value.clocked)return!0}}catch(e){n.e(e)}finally{n.f()}return!1}},{key:"reset",value:function(){var t,n=(0,x.Z)(this.ins);try{for(n.s();!(t=n.n()).done;){var e=(0,c.Z)(t.value,2);e[0];e[1].busVoltage=0}}catch(i){n.e(i)}finally{n.f()}this.eval()}},{key:"in",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"in";return(0,z.hu)(this.ins.has(t),"No pin ".concat(t)),this.ins.get(t)}},{key:"out",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"out";return(0,z.hu)(this.outs.has(t)),this.outs.get(t)}},{key:"pin",value:function(t){return(0,z.hu)(this.pins.has(t)),this.pins.get(t)}},{key:"get",value:function(t,n){return this.ins.has(t)?this.ins.get(t):this.outs.has(t)?this.outs.get(t):this.pins.has(t)?this.pins.get(t):this.getBuiltin(t,n)}},{key:"getBuiltin",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(vt.includes(t)){var e,i=(0,x.Z)(this.parts);try{for(i.s();!(e=i.n()).done;){var r=e.value,a=r.get(t,n);if(a)return a}}catch(s){i.e(s)}finally{i.f()}}}},{key:"isOutPin",value:function(t){return this.outs.has(t)}},{key:"wire",value:function(t,n){this.parts.add(t);var e,i=(0,x.Z)(n);try{for(i.s();!(e=i.n()).done;){var r=e.value,a=r.to,s=r.from;t.isOutPin(a.name)?this.wireOutPin(t,a,s):this.wireInPin(t,a,s)}}catch(u){i.e(u)}finally{i.f()}}},{key:"render",value:function(){return(0,v.Z)(this.parts).map((function(t){return t.render()})).filter((function(t){return void 0!==t}))}},{key:"findPin",value:function(t,n){return"true"===t.toLowerCase()||"1"===t?it:"false"===t.toLowerCase()||"0"===t?rt:this.ins.has(t)?this.ins.get(t):this.outs.has(t)?this.outs.get(t):this.pins.emplace(t,n)}},{key:"wireOutPin",value:function(t,n,e){var i,r,a,s=(0,z.kP)(t.outs.get(n.name),(function(){return"Cannot wire to missing pin ".concat(n.name)}));null!==(i=n.width)&&void 0!==i||(n.width=s.width);var u=this.findPin(e.name,null!==(r=e.width)&&void 0!==r?r:n.width),o=this.pins.has(u.name);if(null!==(a=e.width)&&void 0!==a||(e.width=u.width),u instanceof et)throw new Error("Cannot wire to constant bus");o&&u instanceof Y&&u.ensureWidth(e.start+e.width),(e.start>0||e.width!==u.width)&&(u=new tt(u,e.start,e.width)),(n.start>0||n.width!==u.width)&&(u=new nt(u,n.start,n.width)),s.connect(u)}},{key:"wireInPin",value:function(t,n,e){var i,r,a,s=(0,z.kP)(t.ins.get(n.name),(function(){return"Cannot wire to missing pin ".concat(n.name)}));null!==(i=n.width)&&void 0!==i||(n.width=s.width);var u=this.findPin(e.name,null!==(r=e.width)&&void 0!==r?r:n.width);null!==(a=e.width)&&void 0!==a||(e.width=u.width),(n.start>0||n.width!==u.width)&&(s=new tt(s,n.start,n.width)),["true","false"].includes(u.name)||(e.start>0||e.width!==u.width)&&(s=new nt(s,e.start,e.width)),u.connect(s)}},{key:"eval",value:function(){var t,n=(0,x.Z)(this.parts);try{for(n.s();!(t=n.n()).done;){t.value.eval()}}catch(e){n.e(e)}finally{n.f()}}},{key:"tick",value:function(){this.eval()}},{key:"tock",value:function(){this.eval()}},{key:"remove",value:function(){var t,n=(0,x.Z)(this.parts);try{for(n.s();!(t=n.n()).done;){t.value.remove()}}catch(e){n.e(e)}finally{n.f()}}},{key:"load",value:function(){var t=(0,o.Z)((0,u.Z)().mark((function t(n,e){var i,r,a;return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=(0,x.Z)(this.parts),t.prev=1,i.s();case 3:if((r=i.n()).done){t.next=10;break}if("ROM32K"!==(a=r.value).name){t.next=8;break}return t.next=8,a.load(n,e);case 8:t.next=3;break;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1),i.e(t.t0);case 15:return t.prev=15,i.f(),t.finish(15);case 18:case"end":return t.stop()}}),t,this,[[1,12,15,18]])})));return function(n,e){return t.apply(this,arguments)}}()}]),t}(),ct=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){var t;return(0,i.Z)(this,e),(t=n.call(this,[],[])).outs.insert(rt),t}return(0,r.Z)(e)}(ot),lt=(0,J.Z)("subscription"),ht=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){var t;(0,i.Z)(this,e);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return t=n.call.apply(n,[this].concat(a)),Object.defineProperty((0,_.Z)(t),lt,{writable:!0,value:$.get().$.subscribe((function(n){n.level===Q?t.tock():t.tick()}))}),t}return(0,r.Z)(e,[{key:"clocked",get:function(){return!0}},{key:"remove",value:function(){(0,H.Z)(this,lt)[lt].unsubscribe(),(0,U.Z)((0,W.Z)(e.prototype),"remove",this).call(this)}}]),e}(ot);function dt(t){return Math.pow(2,t)-1}var vt=["Register","ARegister","DRegister","PC","RAM8","RAM64","RAM512","RAM4K","RAM16K","ROM32K","Screen","Keyboard","Memory"];var ft=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){return(0,i.Z)(this,e),n.call(this,["a","b"],["out"])}return(0,r.Z)(e,[{key:"eval",value:function(){var t=function(t,n){return[1===t&&1===n?X:Q]}(this.in("a").voltage(),this.in("b").voltage()),n=(0,c.Z)(t,1)[0];this.out().pull(n)}}]),e}(ot),pt=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){return(0,i.Z)(this,e),n.call(this,["a[16]","b[16]"],["out[16]"])}return(0,r.Z)(e,[{key:"eval",value:function(){var t=function(t,n){return[t&n&65535]}(this.in("a").busVoltage,this.in("b").busVoltage),n=(0,c.Z)(t,1)[0];this.out().busVoltage=n}}]),e}(ot);var mt=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){return(0,i.Z)(this,e),n.call(this,["in","sel"],["a","b"])}return(0,r.Z)(e,[{key:"eval",value:function(){var t=function(t,n){return[n===Q&&t===X?X:Q,n===X&&t===X?X:Q]}(this.in("in").voltage(),this.in("sel").voltage()),n=(0,c.Z)(t,2),e=n[0],i=n[1];this.out("a").pull(e),this.out("b").pull(i)}}]),e}(ot),gt=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){return(0,i.Z)(this,e),n.call(this,["in","sel[2]"],["a","b","c","d"])}return(0,r.Z)(e,[{key:"eval",value:function(){var t=function(t,n){return[0===n&&t===X?X:Q,1===n&&t===X?X:Q,2===n&&t===X?X:Q,3===n&&t===X?X:Q]}(this.in("in").voltage(),this.in("sel").busVoltage),n=(0,c.Z)(t,4),e=n[0],i=n[1],r=n[2],a=n[3];this.out("a").pull(e),this.out("b").pull(i),this.out("c").pull(r),this.out("d").pull(a)}}]),e}(ot),bt=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){return(0,i.Z)(this,e),n.call(this,["in","sel[3]"],["a","b","c","d","e","f","g","h"])}return(0,r.Z)(e,[{key:"eval",value:function(){var t=function(t,n){return[0===n&&t===X?X:Q,1===n&&t===X?X:Q,2===n&&t===X?X:Q,3===n&&t===X?X:Q,4===n&&t===X?X:Q,5===n&&t===X?X:Q,6===n&&t===X?X:Q,7===n&&t===X?X:Q]}(this.in("in").voltage(),this.in("sel").busVoltage),n=(0,c.Z)(t,8),e=n[0],i=n[1],r=n[2],a=n[3],s=n[4],u=n[5],o=n[6],l=n[7];this.out("a").pull(e),this.out("b").pull(i),this.out("c").pull(r),this.out("d").pull(a),this.out("e").pull(s),this.out("f").pull(u),this.out("g").pull(o),this.out("h").pull(l)}}]),e}(ot);function Zt(t,n,e){return[e===Q?t:n]}function yt(t,n,e,i,r){var a=1&r;return 0===(2&r)?Zt(t,n,a):Zt(e,i,a)}var kt=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){return(0,i.Z)(this,e),n.call(this,["a","b","sel"],["out"])}return(0,r.Z)(e,[{key:"eval",value:function(){var t=function(t,n,e){return[e===Q?t:n]}(this.in("a").voltage(),this.in("b").voltage(),this.in("sel").voltage()),n=(0,c.Z)(t,1)[0];this.out().pull(n)}}]),e}(ot),xt=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){return(0,i.Z)(this,e),n.call(this,["a[16]","b[16]","sel"],["out[16]"])}return(0,r.Z)(e,[{key:"eval",value:function(){var t=Zt(this.in("a").busVoltage,this.in("b").busVoltage,this.in("sel").voltage()),n=(0,c.Z)(t,1)[0];this.out().busVoltage=n}}]),e}(ot),wt=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){return(0,i.Z)(this,e),n.call(this,["a[16]","b[16]","c[16]","d[16]","sel[2]"],["out[16]"])}return(0,r.Z)(e,[{key:"eval",value:function(){var t=yt(this.in("a").busVoltage,this.in("b").busVoltage,this.in("c").busVoltage,this.in("d").busVoltage,this.in("sel").busVoltage),n=(0,c.Z)(t,1)[0];this.out().busVoltage=n}}]),e}(ot),jt=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){return(0,i.Z)(this,e),n.call(this,["a[16]","b[16]","c[16]","d[16]","e[16]","f[16]","g[16]","h[16]","sel[3]"],["out[16]"])}return(0,r.Z)(e,[{key:"eval",value:function(){var t=function(t,n,e,i,r,a,s,u,o){var c=3&o;return 0===(4&o)?yt(t,n,e,i,c):yt(r,a,s,u,c)}(this.in("a").busVoltage,this.in("b").busVoltage,this.in("c").busVoltage,this.in("d").busVoltage,this.in("e").busVoltage,this.in("f").busVoltage,this.in("g").busVoltage,this.in("h").busVoltage,this.in("sel").busVoltage),n=(0,c.Z)(t,1)[0];this.out().busVoltage=n}}]),e}(ot);var Ct=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){return(0,i.Z)(this,e),n.call(this,["a","b"],["out"])}return(0,r.Z)(e,[{key:"eval",value:function(){var t=function(t,n){return[1===t&&1===n?Q:X]}(this.in("a").voltage(),this.in("b").voltage()),n=(0,c.Z)(t,1)[0];this.out().pull(n)}}]),e}(ot),St=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){return(0,i.Z)(this,e),n.call(this,["a[16]","b[16]"],["out[16]"])}return(0,r.Z)(e,[{key:"eval",value:function(){var t=this.in("a").busVoltage,n=this.in("b").busVoltage;this.out().busVoltage=(0,S.C2)(t,n)}}]),e}(ot);var At=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){return(0,i.Z)(this,e),n.call(this,["in"],["out"])}return(0,r.Z)(e,[{key:"eval",value:function(){var t=this.in("in").voltage(),n=[t===Q?X:Q],e=(0,c.Z)(n,1)[0];this.out().pull(e)}}]),e}(ot),Mt=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){return(0,i.Z)(this,e),n.call(this,["in[16]"],["out[16]"])}return(0,r.Z)(e,[{key:"eval",value:function(){var t=[65535&~this.in().busVoltage],n=(0,c.Z)(t,1)[0];this.out().busVoltage=n}}]),e}(ot);function Pt(t,n){return[1===t||1===n?X:Q]}var Vt=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){return(0,i.Z)(this,e),n.call(this,["a","b"],["out"])}return(0,r.Z)(e,[{key:"eval",value:function(){var t=Pt(this.in("a").voltage(),this.in("b").voltage()),n=(0,c.Z)(t,1)[0];this.out().pull(n)}}]),e}(ot),Dt=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){return(0,i.Z)(this,e),n.call(this,["a[16]","b[16]"],["out[16]"])}return(0,r.Z)(e,[{key:"eval",value:function(){var t=function(t,n){return[65535&(t|n)]}(this.in("a").busVoltage,this.in("b").busVoltage),n=(0,c.Z)(t,1)[0];this.out().busVoltage=n}}]),e}(ot),Ot=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){return(0,i.Z)(this,e),n.call(this,["in[8]"],["out"],"Or8way")}return(0,r.Z)(e,[{key:"eval",value:function(){var t=this.in().busVoltage,n=[0===(255&t)?Q:X],e=(0,c.Z)(n,1)[0];this.out().pull(e)}}]),e}(ot);var Nt=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){return(0,i.Z)(this,e),n.call(this,["a","b"],["out"])}return(0,r.Z)(e,[{key:"eval",value:function(){var t=function(t,n){return[t===X&&n===Q||t===Q&&n===X?X:Q]}(this.in("a").voltage(),this.in("b").voltage()),n=(0,c.Z)(t,1)[0];this.out().pull(n)}}]),e}(ot),Rt=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){return(0,i.Z)(this,e),n.call(this,["a[16]","b[16]"],["out[16]"])}return(0,r.Z)(e,[{key:"eval",value:function(){var t=function(t,n){return[65535&(t^n)]}(this.in("a").busVoltage,this.in("b").busVoltage),n=(0,c.Z)(t,1)[0];this.out().busVoltage=n}}]),e}(ot);function Ft(t,n){return[t+n&65535]}var Lt=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){return(0,i.Z)(this,e),n.call(this,["a[16]","b[16]"],["out[16]"],"Add16")}return(0,r.Z)(e,[{key:"eval",value:function(){var t=Ft(this.in("a").busVoltage,this.in("b").busVoltage),n=(0,c.Z)(t,1)[0];this.out().busVoltage=n}}]),e}(ot),Et=e(5782),Tt=function(t){var n,e=t.A,i=t.op,r=t.D,a=t.out,s=t.flag;return(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{children:"ALU"}),(0,m.jsxs)("dl",{children:[(0,m.jsx)("dt",{children:"A"})," ",(0,m.jsx)("dd",{children:(0,S.Ly)(e)}),(0,m.jsx)("dt",{children:"op"})," ",(0,m.jsx)("dd",{children:null!==(n=Et.PH.op[i])&&void 0!==n?n:"(??)"}),(0,m.jsx)("dt",{children:"D"})," ",(0,m.jsx)("dd",{children:(0,S.Ly)(r)}),(0,m.jsx)("dt",{children:"="})," ",(0,m.jsx)("dd",{children:(0,S.Ly)(a)}),(0,m.jsx)("dd",{children:Et.vU[s]})]})]})},It=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){return(0,i.Z)(this,e),n.call(this,["x[16]","y[16]","zx","nx","zy","ny","f","no"],["out[16]"],"ALU")}return(0,r.Z)(e,[{key:"eval",value:function(){var t=this.in("x").busVoltage,n=this.in("y").busVoltage,e=(this.in("zx").busVoltage<<5)+(this.in("nx").busVoltage<<4)+(this.in("zy").busVoltage<<3)+(this.in("ny").busVoltage<<2)+(this.in("f").busVoltage<<1)+(this.in("no").busVoltage<<0),i=(0,Et.Bb)(e,t,n),r=(0,c.Z)(i,1)[0];this.out().busVoltage=r}}]),e}(ot),Bt=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){return(0,i.Z)(this,e),n.call(this,["x[16]","y[16]","zx","nx","zy","ny","f","no"],["out[16]","zr","ng"],"ALU")}return(0,r.Z)(e,[{key:"render",value:function(){return[(0,m.jsx)(Tt,{A:this.in("x").busVoltage,op:this.op(),D:this.in("y").busVoltage,out:this.out().busVoltage,flag:this.out("zr").voltage()===X?Et.vU.Zero:this.out("ng").voltage()===X?Et.vU.Negative:Et.vU.Positive})]}},{key:"eval",value:function(){var t=this.in("x").busVoltage,n=this.in("y").busVoltage,e=(this.in("zx").busVoltage<<5)+(this.in("nx").busVoltage<<4)+(this.in("zy").busVoltage<<3)+(this.in("ny").busVoltage<<2)+(this.in("f").busVoltage<<1)+(this.in("no").busVoltage<<0),i=(0,Et.Bb)(e,t,n),r=(0,c.Z)(i,2),a=r[0],s=r[1],u=s===Et.vU.Negative?X:Q,o=s===Et.vU.Zero?X:Q;this.out("out").busVoltage=a,this.out("ng").pull(u),this.out("zr").pull(o)}},{key:"op",value:function(){var t=(this.in("zx").busVoltage<<5)+(this.in("nx").busVoltage<<4)+(this.in("zy").busVoltage<<3)+(this.in("ny").busVoltage<<2)+(this.in("f").busVoltage<<1)+(this.in("no").busVoltage<<0);return t}}]),e}(ot);function _t(t,n){return[1===t&&0===n||0===t&&1===n?X:Q,1===t&&1===n?X:Q]}var Ut=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){return(0,i.Z)(this,e),n.call(this,["a","b"],["sum","carry"])}return(0,r.Z)(e,[{key:"eval",value:function(){var t=_t(this.in("a").voltage(),this.in("b").voltage()),n=(0,c.Z)(t,2),e=n[0],i=n[1];this.out("sum").pull(e),this.out("carry").pull(i)}}]),e}(ot);var Wt=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){return(0,i.Z)(this,e),n.call(this,["a","b","c"],["sum","carry"])}return(0,r.Z)(e,[{key:"eval",value:function(){var t=function(t,n,e){var i=_t(t,n),r=(0,c.Z)(i,2),a=r[0],s=r[1],u=_t(a,e),o=(0,c.Z)(u,2),l=o[0],h=Pt(s,o[1]);return[l,(0,c.Z)(h,1)[0]]}(this.in("a").voltage(),this.in("b").voltage(),this.in("c").voltage()),n=(0,c.Z)(t,2),e=n[0],i=n[1];this.out("sum").pull(e),this.out("carry").pull(i)}}]),e}(ot);var Ht=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){return(0,i.Z)(this,e),n.call(this,["in[16]"],["out[16]"],"Inc16")}return(0,r.Z)(e,[{key:"eval",value:function(){var t=this.in().busVoltage,n=Ft(t,1),e=(0,c.Z)(n,1)[0];this.out().busVoltage=e}}]),e}(ot),Jt=function(t){var n=t.name,e=t.bits;return(0,m.jsxs)("div",{children:[n,": ",(0,S.E_)(e)]})},Kt=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(t){var r;return(0,i.Z)(this,e),(r=n.call(this,["in","load"],["out"],t)).bit=Q,r}return(0,r.Z)(e,[{key:"tick",value:function(){this.in("load").voltage()===X&&(this.bit=this.in().voltage())}},{key:"tock",value:function(){var t;this.out().pull(null!==(t=this.bit)&&void 0!==t?t:0)}}]),e}(ht),zt=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(t){var r;return(0,i.Z)(this,e),(r=n.call(this,["in[16]","load"],["out[16]"],t)).bits=0,r}return(0,r.Z)(e,[{key:"tick",value:function(){this.in("load").voltage()===X&&(this.bits=65535&this.in().busVoltage)}},{key:"tock",value:function(){this.out().busVoltage=65535&this.bits}},{key:"get",value:function(t,n){return t===this.name?this.out():(0,U.Z)((0,W.Z)(e.prototype),"get",this).call(this,t,n)}}]),e}(ht),Gt=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){return(0,i.Z)(this,e),n.apply(this,arguments)}return(0,r.Z)(e,[{key:"render",value:function(){var t;return[(0,m.jsx)(Jt,{name:null!==(t=this.name)&&void 0!==t?t:"Chip ".concat(this.id),bits:this.bits})]}}]),e}(zt),qt=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(t){var r;return(0,i.Z)(this,e),(r=n.call(this,["in[16]","load","inc","reset"],["out[16]"],t)).bits=0,r}return(0,r.Z)(e,[{key:"render",value:function(){return[(0,m.jsx)(Jt,{name:"PC",bits:this.bits})]}},{key:"tick",value:function(){this.in("reset").voltage()===X?this.bits=0:this.in("load").voltage()===X?this.bits=65535&this.in().busVoltage:this.in("inc").voltage()===X&&(this.bits+=1)}},{key:"tock",value:function(){this.out().busVoltage=65535&this.bits}},{key:"get",value:function(t,n){return t===this.name?this.out():(0,U.Z)((0,W.Z)(e.prototype),"get",this).call(this,t,n)}}]),e}(ht),$t=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(t){return(0,i.Z)(this,e),n.call(this,["in"],["out"],t,["t"])}return(0,r.Z)(e,[{key:"tick",value:function(){var t=this.in().voltage();this.pin("t").pull(t)}},{key:"tock",value:function(){var t=this.pin("t").voltage();this.out().pull(t)}}]),e}(ht),Xt=e(8147),Qt=(e(345),e(1291)),Yt='ASM <: Base {\n  Root := ASM\n  ASM = Instruction*\n  \n  Instruction = Label|AInstruction|CInstruction\n  \n  Label = OpenParen identifier closeParen\n  AInstruction = at (identifier | decNumber)\n  CInstruction = assign? op jmp?\n  \n  assign = (\n      "AMD"\n      | "AM"\n      | "AD"\n      | "MD"\n      | "M"\n      | "D"\n      | "A"\n      ) equal\n      \n  op =\n      | "0" | "1" | "-1"\n      | "!D" | "!A" | "!M"\n      | "-D" | "-A" | "-M"\n      | "D+1" | "A+1" | "M+1"\n      | "D-1" | "A-1" | "M-1"\n      | "D+A" | "D+M"\n      | "D-A" | "D-M"\n      | "A-D" | "M-D"\n      | "D&A" | "D&M"\n      | "D|A" | "D|M"\n      | "D" | "A" | "M"\n\n\n  jmp = semi ("JGT" | "JEQ" | "JGE" | "JLT" | "JNE" | "JLE" | "JMP")\n}',tn=C.Z.grammar(Yt,M),nn=tn.extendSemantics(P);function en(t){return void 0!==t.label}nn.addAttribute("asm",{Root:function(t){return{instructions:t.child(0).children.map((function(t){return t.instruction}))}}}),nn.addAttribute("instruction",{AInstruction:function(t,n){try{return{type:"A",value:n.value}}catch(e){}try{return{type:"A",label:n.name}}catch(e){}throw new Error("AsmAInstruction must have either a name or a value")},CInstruction:function(t,n,e){var i,r,a,s,u=null===(i=t.child(0))||void 0===i||null===(r=i.child(0))||void 0===r?void 0:r.sourceString,o=n.sourceString,c=null===(a=e.child(0))||void 0===a||null===(s=a.child(1))||void 0===s?void 0:s.sourceString,l=t.sourceString.includes("M")||n.sourceString.includes("M"),h={type:"C",op:Et.PH.asm[o],isM:l};return c&&(h.jump=Et.lK.asm[c]),u&&(h.store=Et.Uc.asm[u]),h},Label:function(t,n,e){return{type:"L",label:n.name}}});var rn={grammar:Yt,semantics:nn,parser:tn,parse:V(tn,nn),passes:{fillLabel:function(t){var n,e=new Map([["R0",0],["R1",1],["R2",2],["R3",3],["R4",4],["R5",5],["R6",6],["R7",7],["R8",8],["R9",9],["R10",10],["R11",11],["R12",12],["R13",13],["R14",14],["R15",15],["SP",0],["LCL",1],["ARG",2],["THIS",3],["THAT",4],["SCREEN",dn],["KBD",vn]]),i=[],r=0,a=(0,x.Z)(t.instructions);try{for(a.s();!(n=a.n()).done;){var s=n.value;if("L"!==s.type)r+=1,"A"===s.type&&en(s)&&i.push(s);else{if(e.has(s.label))throw new Error("ASM Duplicate label ".concat(s.label));e.set(s.label,r)}}}catch(u){a.e(u)}finally{a.f()}i.forEach((function(t){var n=(0,z.kP)(e.get(t.label));t.value=n,delete t.label}))},emit:function(t){return t.instructions.map((function(t){if("A"===t.type){if(en(t))throw new Error("ASM Emitting unfilled A instruction");return t.value}if("C"===t.type)return(0,Qt.p)(t.isM,t.op,t.store,t.jump)})).filter((function(t){return void 0!==t}))}}};function an(t,n){return sn.apply(this,arguments)}function sn(){return sn=(0,o.Z)((0,u.Z)().mark((function t(n,e){return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.endsWith(".hack")){t.next=2;break}return t.abrupt("return",cn(n,e));case 2:if(!e.endsWith(".asm")){t.next=4;break}return t.abrupt("return",un(n,e));case 4:throw new Error("Cannot load file without hack or asm extension ".concat(e));case 5:case"end":return t.stop()}}),t)}))),sn.apply(this,arguments)}function un(t,n){return on.apply(this,arguments)}function on(){return on=(0,o.Z)((0,u.Z)().mark((function t(n,e){var i,r,a;return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.readFile(e);case 2:if(i=t.sent,r=rn.parse(i),!(0,w.dZ)(r)){t.next=6;break}throw(0,w.UG)(r);case 6:return a=(0,w.Ok)(r),rn.passes.fillLabel(a),t.abrupt("return",rn.passes.emit(a));case 9:case"end":return t.stop()}}),t)}))),on.apply(this,arguments)}function cn(t,n){return ln.apply(this,arguments)}function ln(){return ln=(0,o.Z)((0,u.Z)().mark((function t(n,e){return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.readFile(e);case 2:return t.abrupt("return",t.sent.split("\n").filter((function(t){return""!==t.trim()})).map(S.C$));case 3:case"end":return t.stop()}}),t)}))),ln.apply(this,arguments)}var hn=["bin","dec","hex","asm"],dn=16384,vn=24576,fn=(0,J.Z)("memory"),pn=function(){function t(n){(0,i.Z)(this,t),Object.defineProperty(this,fn,{writable:!0,value:void 0}),(0,H.Z)(this,fn)[fn]=new Int16Array(n)}return(0,r.Z)(t,[{key:"size",get:function(){return(0,H.Z)(this,fn)[fn].length}},{key:"get",value:function(t){var n;return t<0||t>=this.size?65535:null!==(n=(0,H.Z)(this,fn)[fn][t])&&void 0!==n?n:0}},{key:"set",value:function(t,n){t>=0&&t<this.size&&((0,H.Z)(this,fn)[fn][t]=65535&n)}},{key:"update",value:function(t,n,e){var i;switch(e){case"asm":i=(0,Qt.op)(n);break;case"bin":i=(0,S.C$)(n);break;case"hex":i=(0,S.Af)(n);break;default:i=(0,S.o5)(n)}isFinite(i)&&i<=65535&&this.set(t,i)}},{key:"load",value:function(){var t=(0,o.Z)((0,u.Z)().mark((function t(n,e){var i=this;return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,an(n,e);case 3:t.sent.map((function(t,n){return i.set(n,t)})),t.next=9;break;case 6:throw t.prev=6,t.t0=t.catch(0),new Error("Memory Failed to load file ".concat(e));case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(n,e){return t.apply(this,arguments)}}()},{key:"map",value:(0,u.Z)().mark((function t(n){var e,i,r,a=arguments;return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=a.length>1&&void 0!==a[1]?a[1]:0,i=a.length>2&&void 0!==a[2]?a[2]:this.size,(0,z.hu)(e<i),r=e;case 4:if(!(r<i)){t.next=10;break}return t.next=7,n(r,this.get(r));case 7:r++,t.next=4;break;case 10:case"end":return t.stop()}}),t,this)}))}]),t}(),mn=e(3405),gn=0,bn=1,Zn=function(t){var n,e=(0,h.useState)(null!==(n=t.mode)&&void 0!==n?n:gn),i=(0,c.Z)(e,2),r=i[0],a=i[1],s=function(){return(0,m.jsx)("span",{style:(0,d.Z)({cursor:"text"},(0,mn.b)("full","inline")),onClick:function(){a(bn)},children:t.value})},u=(0,h.useCallback)((function(t){return null===t||void 0===t?void 0:t.select()}),[]),o=(0,h.useCallback)((function(n){var e;a(gn),t.onChange(null!==(e=n.value)&&void 0!==e?e:"")}),[t]),l=function(){var n=(0,m.jsx)("span",{style:{display:"block",position:"relative"},children:(0,m.jsx)("input",{ref:u,style:{zIndex:"10",position:"absolute",left:"0",marginTop:"-0.375rem"},onBlur:function(t){var n=t.target;return o(n)},onKeyPress:function(t){var n=t.key,e=t.target;"Enter"===n&&o(e)},type:"text",defaultValue:t.value})});return n};return function(){switch(r){case bn:return l();case gn:return s();default:return(0,m.jsx)("span",{})}}()};function yn(t,n,e){var i=n.totalHeight,r=n.toleranceHeight,a=n.bufferedItems,s=n.settings,u=s.itemHeight,o=s.minIndex,c=s.maxIndex,l=o+Math.floor((t-r)/u),h=function(t,n,e,i,r){var a=Math.max(0,t,e),s=r(a,Math.min(n,e+i-1)-a);return(0,v.Z)(s)}(o,c,l,a,e),d=Math.max((l-o)*u,0);return{scrollTop:t,topPaddingHeight:d,bottomPaddingHeight:Math.max(i-(d+h.length*u),0),data:h}}var kn=function(t){var n,e,i=function(t){var n=t.minIndex,e=void 0===n?0:n,i=t.maxIndex,r=void 0===i?Number.MAX_SAFE_INTEGER:i,a=t.startIndex,s=void 0===a?0:a,u=t.itemHeight,o=void 0===u?20:u,c=t.count,l=void 0===c?r-e+1:c,h=t.tolerance;return{minIndex:e,maxIndex:r,startIndex:s,itemHeight:o,count:l,tolerance:void 0===h?l:h}}(null!==(n=t.settings)&&void 0!==n?n:{}),r=(0,h.useMemo)((function(){return function(t){return function(n,e){var i=e.scrollTop;return(0,d.Z)((0,d.Z)({},n),yn(i,n,t))}}(t.get)}),[t.get]),a=(0,h.useMemo)((function(){return function(t,n){var e=t.minIndex,i=t.maxIndex,r=t.startIndex,a=t.itemHeight,s=t.count,u=t.tolerance,o=s+2*u,c=s*a,l=(i-e+1)*a,h=u*a,v=Math.max(0,r-u-e)*a,f={scrollTop:0,settings:t,viewportHeight:c,totalHeight:l,toleranceHeight:h,bufferedItems:o,topPaddingHeight:v,bottomPaddingHeight:l-(v+(c+2*h)),data:[]};return(0,d.Z)((0,d.Z)({},f),yn(0,f,n))}(i,t.get)}),[i,t.get]),s=(0,h.useReducer)(r,a),u=(0,c.Z)(s,2),o=u[0],l=u[1],v=(0,h.useCallback)((function(t){var n,e=t.target;l({scrollTop:null!==(n=null===e||void 0===e?void 0:e.scrollTop)&&void 0!==n?n:0})}),[l]),f=(0,h.useRef)();return(0,m.jsxs)("div",{ref:function(t){return f.current=null!==t&&void 0!==t?t:void 0},style:{height:"".concat(o.viewportHeight,"px"),overflowY:"scroll"},className:null!==(e=t.className)&&void 0!==e?e:"",onScroll:v,children:[(0,m.jsx)("div",{className:"VirtualScroll__topPadding",style:{height:"".concat(o.topPaddingHeight,"px")}}),o.data.map((function(n,e){return(0,m.jsx)("div",{style:{height:"".concat(i.itemHeight,"px")},children:t.row(n)},e)})),(0,m.jsx)("div",{className:"VirtualScroll__bottomPadding",style:{height:"".concat(o.bottomPaddingHeight,"px")}})]})},xn=e(5852),wn=e(5996),jn=function(t){var n=t.memory,e=t.highlight,i=void 0===e?-1:e,r=t.editable,a=void 0!==r&&r,s=t.format,u=void 0===s?S.E_:s,o=t.onChange,l=void 0===o?function(){}:o;return(0,m.jsx)(kn,{className:"panel-fill",settings:{count:20,maxIndex:n.size,itemHeight:34},get:function(t,e){return n.map((function(t,n){return[t,n]}),t,t+e)},row:function(t){var n=(0,c.Z)(t,2),e=n[0],r=n[1];return(0,m.jsx)(Cn,{index:e,value:u(r),editable:a,highlight:e===i,onChange:l})}})},Cn=function(t){var n=t.index,e=t.value,i=t.highlight,r=void 0!==i&&i,a=t.editable,s=void 0!==a&&a,u=t.onChange,o=void 0===u?function(){}:u;return(0,m.jsxs)("div",{style:{display:"flex",height:"100%"},children:[(0,m.jsx)("code",{style:(0,d.Z)((0,d.Z)({},(0,Xt.eP)("none")),r?{background:"var(--code-kbd-background-color)"}:{}),children:(0,S.$v)(n)}),(0,m.jsx)("code",{style:(0,d.Z)((0,d.Z)({flex:"1",textAlign:"right"},(0,Xt.eP)("none")),r?{background:"var(--code-kbd-background-color)"}:{}),children:s?(0,m.jsx)(Zn,{value:e,onChange:function(t){return o(n,t,Number(e))}}):(0,m.jsx)("span",{children:e})})]})},Sn=function(t){var n=t.name,e=void 0===n?"Memory":n,i=t.highlight,r=void 0===i?-1:i,a=t.editable,s=void 0===a||a,l=t.memory,d=t.format,v=void 0===d?"dec":d,f=(0,h.useContext)(wn.Il).setStatus,p=(0,h.useState)(v),g=(0,c.Z)(p,2),b=g[0],Z=g[1],y=(0,h.useContext)(wn.Il).fs,k=(0,h.useCallback)((0,o.Z)((0,u.Z)().mark((function t(){return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,l.load(y,"/samples/Add.hack");case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),f((0,j.j)(t.t0.message));case 8:case"end":return t.stop()}}),t,null,[[0,5]])}))),[y,l,f]);return(0,m.jsxs)("article",{className:"panel",children:[(0,m.jsxs)("header",{children:[(0,m.jsxs)("fieldset",{role:"group",children:[(0,m.jsx)("label",{children:e}),(0,m.jsx)("button",{onClick:k,children:(0,m.jsx)(xn.J,{name:"upload_file"})})]}),(0,m.jsx)("fieldset",{role:"group",children:hn.map((function(t){return(0,m.jsxs)("label",{role:"button","aria-current":t===b,children:[(0,m.jsx)("input",{type:"radio",name:e,value:t,checked:t===b,onChange:function(){return Z(t)}}),t]},t)}))})]}),(0,m.jsx)(jn,{memory:l,highlight:r,editable:s,format:function(t){return function(t,n){switch(t){case"bin":return(0,S.Ly)(n);case"hex":return(0,S.$v)(n);case"asm":return(0,Qt.a)(n);default:return(0,S.E_)(n)}}(null!==b&&void 0!==b?b:"dec",t)},onChange:function(t,n){l.update(t,n,null!==b&&void 0!==b?b:"dec")}})]})};var An=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(t,r){var a;return(0,i.Z)(this,e),(a=n.call(this,["in[16]","load","address[".concat(t,"]")],["out[16]"],r)).width=t,a.memory=void 0,a.nextData=0,a.address=0,a.memory=new pn(Math.pow(2,a.width)),a}return(0,r.Z)(e,[{key:"tick",value:function(){var t=this.in("load").voltage();this.address=this.in("address").busVoltage,t&&(this.nextData=this.in().busVoltage,this.memory.set(this.address,this.nextData))}},{key:"tock",value:function(){var t,n;this.out().busVoltage=null!==(t=null===(n=this.memory)||void 0===n?void 0:n.get(this.address))&&void 0!==t?t:0}},{key:"eval",value:function(){var t,n,e=this.in("address").busVoltage;this.out().busVoltage=null!==(t=null===(n=this.memory)||void 0===n?void 0:n.get(e))&&void 0!==t?t:0}},{key:"at",value:function(t){var n=this;return(0,z.hu)(t<this.memory.size,(function(){return"Request out of bounds (".concat(t," >= ").concat(n.memory.size,")")})),new Mn("".concat(this.name,"[").concat(t,"]"),t,this.memory)}},{key:"render",value:function(){return[(0,m.jsx)(Sn,{name:this.name,memory:this.memory,format:"dec"})]}}]),e}(ht),Mn=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(t,r,a){var s;return(0,i.Z)(this,e),(s=n.call(this,t)).index=r,s.ram=a,s}return(0,r.Z)(e,[{key:"busVoltage",get:function(){return this.ram.get(this.index)},set:function(t){this.ram.set(this.index,t)}}]),e}(Y),Pn=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(t){return(0,i.Z)(this,e),n.call(this,3,t)}return(0,r.Z)(e,[{key:"render",value:function(){return[(0,m.jsxs)("span",{children:["RAM ",this.width]})]}}]),e}(An),Vn=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(t){return(0,i.Z)(this,e),n.call(this,6,t)}return(0,r.Z)(e)}(An),Dn=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(t){return(0,i.Z)(this,e),n.call(this,9,t)}return(0,r.Z)(e)}(An),On=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(t){return(0,i.Z)(this,e),n.call(this,12,t)}return(0,r.Z)(e)}(An),Nn=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(t){return(0,i.Z)(this,e),n.call(this,14,t)}return(0,r.Z)(e)}(An),Rn=function(t){var n;return(0,m.jsxs)("article",{className:["panel",null!==(n=t.className)&&void 0!==n?n:""].join(" "),children:[t.header&&(0,m.jsx)("header",{children:t.header}),(0,m.jsx)("main",{children:t.children}),t.footer&&(0,m.jsx)("footer",{children:t.footer})]})},Fn=function(t){var n;return(0,m.jsxs)("details",{className:null!==(n=t.className)&&void 0!==n?n:"",open:t.open,style:t.style,children:[(0,m.jsx)("summary",{children:(0,m.jsx)("div",{className:"flex row align-baseline",children:t.summary})}),t.children]})},Ln="white";function En(t,n,e,i){var r=4*(512*e+n),a=i===Ln?255:0;t[r]=a,t[r+1]=a,t[r+2]=a,t[r+3]=255}var Tn=function(t){var n=t.memory,e=(0,h.useRef)();return(0,h.useEffect)((function(){var t,i,r,a,s=null!==(t=null===(i=e.current)||void 0===i?void 0:i.getContext("2d"))&&void 0!==t?t:void 0;if(s){for(var u=(0,z.kP)(s.getImageData(0,0,512,256),"Failed to create Context2d"),o=0;o<512;o++)for(var c=0;c<256;c++){var l=(r=o,a=c,0===(n.get(dn+32*a+(r/16|0))&1<<r%16)?Ln:"black");En(u.data,o,c,l)}s.putImageData(u,0,0)}}),[n]),(0,m.jsx)(Rn,{header:(0,m.jsx)(l.cC,{id:"Screen"}),children:(0,m.jsx)("figure",{style:{width:"100%",maxWidth:"512px",boxSizing:"content-box",marginInline:"auto",margin:"0",borderTop:"2px solid gray",borderLeft:"2px solid gray",borderBottom:"2px solid lightgray",borderRight:"2px solid lightgray"},children:(0,m.jsx)("canvas",{ref:function(t){return e.current=null!==t&&void 0!==t?t:void 0},width:512,height:256})})})},In={Enter:128,Backspace:129,ArrowLeft:130,ArrowUp:131,ArrowRight:132,ArrowDown:133,Home:134,End:135,PageUp:136,PageDown:137,Insert:138,Delete:139,Escape:140,F1:141,F2:142,F3:143,F4:144,F5:145,F6:146,F7:147,F8:148,F9:149,F10:150,F11:151,F12:152};var Bn=function(t){var n=t.keyboard,e=(0,h.useState)(!1),i=(0,c.Z)(e,2),r=i[0],a=i[1],s=(0,h.useState)(n.out().busVoltage),u=(0,c.Z)(s,2),o=u[0],l=u[1],d=(0,h.useCallback)((function(t){var e=function(t){if(In[t.key])return In[t.key];if(1===t.key.length){var n=t.key.charCodeAt(0);if(n>=32&&n<=126)return n}return 0}(t);0!==e&&(t.preventDefault(),n.setKey(e),l(n.out().busVoltage),a(!1))}),[n,a,l]),v=(0,h.useCallback)((function(){a(!0)}),[]);return(0,m.jsxs)("div",{className:"flex row align-baseline",children:[(0,m.jsx)("div",{className:"flex-1",children:(0,m.jsx)(Jt,{name:"Keyboard",bits:o})}),(0,m.jsx)("div",{className:"flex-1",children:r?(0,m.jsx)("input",{ref:function(t){return null===t||void 0===t?void 0:t.focus()},type:"text",onKeyDown:d}):(0,m.jsx)("button",{onClick:v,children:(0,m.jsx)(xn.J,{name:"keyboard"})})})]})};var _n=32768,Un=36864,Wn=36864,Hn=36864,Jn=4032,Kn=32800,zn=32784,Gn=32776,qn=32769,$n=32770,Xn=32772;function Qn(t){function n(n){return(t&n)===n}return{c:n(_n),x1:n(Un),x2:n(Wn),am:n(Hn),op:(t&Jn)>>6,d1:n(Kn),d2:n(zn),d3:n(Gn),j1:n(qn),j2:n($n),j3:n(Xn)}}function Yn(t,n){var e=t.inM,i=t.instruction,r=n.A,a=n.D,s=n.PC,u=Qn(i),o=u.am?e:r,l=(0,Et.Bb)(u.op,a,o),h=(0,c.Z)(l,2);return[{A:r,D:a,PC:s+1,ALU:h[0],flag:h[1]},u.d3]}function te(t,n){var e=t.inM,i=t.instruction,r=t.reset,a=n.A,s=n.D,u=n.PC,o=n.ALU,c=n.flag,l=Qn(i),h=l.j1&&c===Et.vU.Positive,d=l.j2&&c===Et.vU.Zero,v=l.j3&&c===Et.vU.Negative;u=r?0:h||d||v?a:u,l.d2&&(s=o),l.c?l.d1&&(a=o):a=32767&i;var f=l.am?e:a,p=(0,Et.Bb)(l.op,s,f);return o=p[0],c=p[1],[{addressM:a,outM:o,writeM:l.d3},{A:a,D:s,ALU:o,flag:c,PC:u}]}var ne=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){return(0,i.Z)(this,e),n.call(this,16,"ROM")}return(0,r.Z)(e,[{key:"load",value:function(){var t=(0,o.Z)((0,u.Z)().mark((function t(n,e){var i=this;return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,cn(n,e);case 3:t.sent.map((function(t,n){return i.at(n).busVoltage=t})),t.next=9;break;case 6:throw t.prev=6,t.t0=t.catch(0),new Error("ROM32K Failed to load file ".concat(e));case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(n,e){return t.apply(this,arguments)}}()}]),e}(An),ee=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){return(0,i.Z)(this,e),n.call(this,13,"Screen")}return(0,r.Z)(e,[{key:"render",value:function(){return[(0,m.jsx)(Tn,{memory:this.memory})]}}]),e}(An);ee.OFFSET=dn;var ie=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){return(0,i.Z)(this,e),n.call(this,[],["out[16]"],"Keyboard")}return(0,r.Z)(e,[{key:"setKey",value:function(t){this.out().busVoltage=65535&t}},{key:"clearKey",value:function(){this.out().busVoltage=0}},{key:"render",value:function(){return[(0,m.jsx)(Bn,{keyboard:this})]}}]),e}(ot);ie.OFFSET=vn;var re=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){var t;return(0,i.Z)(this,e),(t=n.call(this,["in[16]","load","address[15])"],["out[16]"],"Memory")).ram=new Nn,t.screen=new ee,t.keyboard=new ie,t.address=0,t.parts.add(t.ram),t.parts.add(t.screen),t.parts.add(t.keyboard),t}return(0,r.Z)(e,[{key:"tick",value:function(){var t=this.in("load").voltage();if(this.address=this.in("address").busVoltage,t){var n=this.in().busVoltage;this.address>=ie.OFFSET||(this.address>=ee.OFFSET?this.screen.at(this.address-ee.OFFSET).busVoltage=n:this.ram.at(this.address).busVoltage=n)}}},{key:"tock",value:function(){this.eval()}},{key:"eval",value:function(){if(this.ram){this.address=this.in("address").busVoltage;var t,n,e=0;if(this.address>=ie.OFFSET)e=null!==(t=null===(n=this.keyboard)||void 0===n?void 0:n.out().busVoltage)&&void 0!==t?t:0;else if(this.address>=ee.OFFSET){var i,r;e=null!==(i=null===(r=this.screen)||void 0===r?void 0:r.at(this.address-ee.OFFSET).busVoltage)&&void 0!==i?i:0}else{var a,s;e=null!==(a=null===(s=this.ram)||void 0===s?void 0:s.at(this.address).busVoltage)&&void 0!==a?a:0}this.out().busVoltage=e}}},{key:"in",value:function(t){if(null!==t&&void 0!==t&&t.startsWith("RAM16K")){var n,i,r,a=(0,S.o5)(null!==(n=null===(i=t.match((0,K.Z)(/\[(\d+)\]/,{idx:1})))||void 0===i||null===(r=i.groups)||void 0===r?void 0:r.idx)&&void 0!==n?n:"0");return this.ram.at(a)}if(null!==t&&void 0!==t&&t.startsWith("Screen")){var s,u,o,c=(0,S.o5)(null!==(s=null===(u=t.match((0,K.Z)(/\[(\d+)\]/,{idx:1})))||void 0===u||null===(o=u.groups)||void 0===o?void 0:o.idx)&&void 0!==s?s:"0");return this.screen.at(c)}return(0,U.Z)((0,W.Z)(e.prototype),"in",this).call(this,t)}},{key:"get",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t.startsWith("RAM16K")?this.at(16383&n):t.startsWith("Screen")?this.at(n&8191+ee.OFFSET):t.startsWith("Keyboard")?this.at(ie.OFFSET):t.startsWith("Memory")?this.at(n):(0,U.Z)((0,W.Z)(e.prototype),"get",this).call(this,t,n)}},{key:"at",value:function(t){return t>=ie.OFFSET?this.keyboard.out():t>=ee.OFFSET?this.screen.at(t-ee.OFFSET):this.ram.at(t)}}]),e}(ht),ae=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){var t;return(0,i.Z)(this,e),(t=n.call(this,["inM[16]","instruction[16]","reset"],["outM[16]","writeM","addressM[15]","pc[15]"])).state={A:0,D:0,PC:0,ALU:0,flag:Et.vU.Zero},t}return(0,r.Z)(e,[{key:"tick",value:function(){var t,n=Yn(this.cpuInput(),this.state),e=(0,c.Z)(n,2),i=e[0],r=e[1];this.state=i,this.out("writeM").pull(r?X:Q),this.out("outM").busVoltage=null!==(t=this.state.ALU)&&void 0!==t?t:0}},{key:"tock",value:function(){var t,n,e,i;if(this.state){var r=te(this.cpuInput(),this.state),a=(0,c.Z)(r,2),s=a[0],u=a[1];this.state=u,this.out("addressM").busVoltage=null!==(t=s.addressM)&&void 0!==t?t:0,this.out("outM").busVoltage=null!==(n=s.outM)&&void 0!==n?n:0,this.out("writeM").pull(s.writeM?X:Q),this.out("pc").busVoltage=null!==(e=null===(i=this.state)||void 0===i?void 0:i.PC)&&void 0!==e?e:0}}},{key:"cpuInput",value:function(){return{inM:this.in("inM").busVoltage,instruction:this.in("instruction").busVoltage,reset:1===this.in("reset").busVoltage}}},{key:"get",value:function(t,n){return null!==t&&void 0!==t&&t.startsWith("ARegister")?new et("ARegister",this.state.A):null!==t&&void 0!==t&&t.startsWith("DRegister")?new et("DRegister",this.state.D):null!==t&&void 0!==t&&t.startsWith("PC")?new et("PC",this.state.PC):(0,U.Z)((0,W.Z)(e.prototype),"get",this).call(this,t,n)}},{key:"render",value:function(){var t=Qn(this.in("instruction").busVoltage);return[(0,m.jsx)(Jt,{name:"A",bits:this.state.A}),(0,m.jsx)(Jt,{name:"D",bits:this.state.D}),(0,m.jsx)(Jt,{name:"PC",bits:this.state.PC}),(0,m.jsx)(Tt,{A:t.am?this.in("inM").busVoltage:this.state.A,D:this.state.D,out:this.state.ALU,op:t.op,flag:this.state.flag})]}}]),e}(ht),se=(0,J.Z)("ram"),ue=(0,J.Z)("rom"),oe=(0,J.Z)("cpu"),ce=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){var t;return(0,i.Z)(this,e),t=n.call(this,["reset"],[]),Object.defineProperty((0,_.Z)(t),se,{writable:!0,value:new re}),Object.defineProperty((0,_.Z)(t),ue,{writable:!0,value:new ne}),Object.defineProperty((0,_.Z)(t),oe,{writable:!0,value:new ae}),t.wire((0,H.Z)((0,_.Z)(t),oe)[oe],[{from:{name:"reset",start:0},to:{name:"reset",start:0}},{from:{name:"instruction",start:0},to:{name:"instruction",start:0}},{from:{name:"outM",start:0},to:{name:"inM",start:0}},{from:{name:"writeM",start:0},to:{name:"writeM",start:0}},{from:{name:"addressM",start:0},to:{name:"addressM",start:0}}]),t.wire((0,H.Z)((0,_.Z)(t),ue)[ue],[{from:{name:"pc",start:0},to:{name:"address",start:0}},{from:{name:"instruction",start:0},to:{name:"out",start:0}}]),t.wire((0,H.Z)((0,_.Z)(t),se)[se],[{from:{name:"inM",start:0},to:{name:"in",start:0}},{from:{name:"writeM",start:0},to:{name:"load",start:0}},{from:{name:"addressM",start:0},to:{name:"address",start:0}},{from:{name:"outM",start:0},to:{name:"out",start:0}}]),t}return(0,r.Z)(e,[{key:"eval",value:function(){(0,U.Z)((0,W.Z)(e.prototype),"eval",this).call(this)}},{key:"get",value:function(t,n){return t.startsWith("PC")||t.startsWith("ARegister")||t.startsWith("DRegister")?(0,H.Z)(this,oe)[oe].get(t):t.startsWith("RAM16K")?(0,H.Z)(this,se)[se].get(t,n):(0,U.Z)((0,W.Z)(e.prototype),"get",this).call(this,t,n)}},{key:"load",value:function(t,n){return(0,H.Z)(this,ue)[ue].load(t,n)}}]),e}(ot),le=new Map([["Nand",Ct],["Nand16",St],["Not",At],["Not16",Mt],["And",ft],["And16",pt],["Or",Vt],["Or16",Dt],["Or8Way",Ot],["XOr",Nt],["XOr16",Rt],["Xor",Nt],["Xor16",Rt],["Mux",kt],["Mux16",xt],["Mux4Way16",wt],["Mux8Way16",jt],["DMux",mt],["DMux4Way",gt],["DMux8Way",bt],["HalfAdder",Ut],["FullAdder",Wt],["Add16",Lt],["Inc16",Ht],["ALU",Bt],["ALUNoStat",It],["DFF",$t],["Bit",Kt],["Register",zt],["ARegister",zt],["DRegister",zt],["PC",qt],["RAM8",Pn],["RAM64",Vn],["RAM512",Dn],["RAM4K",On],["RAM16K",Nn],["ROM32K",ne],["Screen",ee],["Keyboard",ie],["CPU",ae],["Computer",ce],["Memory",re],["ARegister",Gt],["DRegister",Gt]].map((function(t){var n=(0,c.Z)(t,2),e=n[0],i=n[1];return[e,function(){var t=new i;return t.name=e,t}]})));function he(t){var n=le.get(t);return n?(0,w.Ok)(n()):(0,w.UG)(new Error("Chip ".concat(t," not in builtin registry")))}function de(t,n){if(void 0!==n){if(n>=t)return n-t+1;if(t>0&&0===n)return 1;throw new Error("Bus specification has start > end (".concat(t," > ").concat(n,")"))}}function ve(t){if("BUILTIN"===t.parts)return he(t.name.toString());var n,e=new ot(t.ins.map((function(t){var n=t.pin,e=t.width;return{pin:n.toString(),width:e}})),t.outs.map((function(t){var n=t.pin,e=t.width;return{pin:n.toString(),width:e}})),t.name.toString(),[],t.clocked),i=(0,x.Z)(t.parts);try{for(i.s();!(n=i.n()).done;){var r=n.value,a=he(r.name.toString());if((0,w.dZ)(a))return a;var s=(0,w.Ok)(a),u=r.wires.map((function(t){var n,e,i,r,a=t.lhs,s=t.rhs;return{to:{name:a.pin.toString(),start:null!==(n=a.start)&&void 0!==n?n:0,width:de(null!==(e=a.start)&&void 0!==e?e:0,a.end)},from:{name:s.pin.toString(),start:null!==(i=s.start)&&void 0!==i?i:0,width:de(null!==(r=s.start)&&void 0!==r?r:0,s.end)}}}));try{e.wire(s,u)}catch(o){return(0,w.UG)(o)}}}catch(c){i.e(c)}finally{i.f()}return(0,w.Ok)(e)}var fe=e(2454),pe=function(){function t(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"%B1.1.1",r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,u=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0;if((0,i.Z)(this,t),this.variable=n,this.fmt=void 0,this.lPad=void 0,this.rPad=void 0,this.len=void 0,this.index=void 0,this.builtin=void 0,e.startsWith("%")&&void 0===r&&void 0===a&&void 0===s){var c,l=null===(c=e.match((0,K.Z)(/^%([BDXS])(\d+)\.(\d+)\.(\d+)$/,{fmt:1,lPad:2,len:3,rPad:4})))||void 0===c?void 0:c.groups,h=l.fmt,d=l.lPad,v=l.rPad,f=l.len;this.fmt=h,this.lPad=parseInt(d),this.rPad=parseInt(v),this.len=parseInt(f),this.builtin=!1,this.index=-1}else(0,z.hu)(["B","X","D","S"].includes(e[0])),this.fmt=e[0],this.len=null!==r&&void 0!==r?r:3,this.lPad=null!==a&&void 0!==a?a:1,this.rPad=null!==s&&void 0!==s?s:1,this.builtin=null!==u&&void 0!==u&&u,this.index=null!==o&&void 0!==o?o:-1}return(0,r.Z)(t,[{key:"header",value:function(t){var n="".concat(this.variable);if(this.builtin){var e=this.index>=0?this.index:"";n="".concat(n,"[").concat(e,"]")}return n.length>this.len+this.lPad+this.rPad?n.substring(0,this.len+this.lPad+this.rPad):this.padCenter(n)}},{key:"print",value:function(t){var n=t.getVar(this.variable,this.index);if("S"===this.fmt)return this.padLeft(n);var e=(0,{B:S.Ly,D:S.E_,X:S.$v}[this.fmt])(n);return"D"===this.fmt?this.padRight(e):this.padCenter(e.slice(e.length-this.len))}},{key:"padCenter",value:function(t){var n=this.lPad+this.len+this.rPad,e=Math.floor((n-t.length)/2),i=n-e-t.length,r=e+t.length,a=r+i;return t=(t=t.padStart(r)).padEnd(a)}},{key:"padLeft",value:function(t){t=t.substring(0,this.len);var n=this.rPad+this.len,e=this.lPad+n;return t=(t=t.padEnd(n)).padStart(e)}},{key:"padRight",value:function(t){t=t.substring(0,this.len);var n=this.lPad+this.len,e=this.rPad+n;return t=(t=t.padStart(n)).padEnd(e)}}]),t}(),me=function(){function t(){(0,i.Z)(this,t),this.instructions=[],this._outputList=[],this._log="",this.fs=new fe.Wd,this._steps=void 0,this._step=void 0,this.breakpoints=new Map}return(0,r.Z)(t,[{key:"setFileSystem",value:function(t){this.fs=t}},{key:"load",value:function(){var t=(0,o.Z)((0,u.Z)().mark((function t(n){return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}()},{key:"compareTo",value:function(){var t=(0,o.Z)((0,u.Z)().mark((function t(n){return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}()},{key:"outputFile",value:function(t){}},{key:"outputList",value:function(t){this._outputList=t}},{key:"addInstruction",value:function(t){this.instructions.push(t)}},{key:"reset",value:function(){this._steps=this.instructions[Symbol.iterator](),this._log=""}},{key:"steps",get:function(){return void 0===this._steps&&this.reset(),this._steps}},{key:"currentStep",get:function(){var t;return null===(t=this._step)||void 0===t?void 0:t.value}},{key:"step",value:function(){var t=(0,o.Z)((0,u.Z)().mark((function t(){return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._step=this.steps.next(),this._step.done){t.next=5;break}return t.next=4,this._step.value.do(this);case 4:return t.abrupt("return",!0);case 5:return t.abrupt("return",!1);case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"run",value:function(){var t=(0,o.Z)((0,u.Z)().mark((function t(){return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.step();case 2:if(!t.sent){t.next=6;break}t.next=0;break;case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"echo",value:function(t){}},{key:"clearEcho",value:function(){}},{key:"addBreakpoint",value:function(t,n){this.breakpoints.set(t,n)}},{key:"clearBreakpoints",value:function(){this.breakpoints.clear()}},{key:"output",value:function(){var t=this,n=this._outputList.map((function(n){return n.print(t)}));this._log+="|".concat(n.join("|"),"|\n")}},{key:"header",value:function(){var t=this,n=this._outputList.map((function(n){return n.header(t)}));this._log+="|".concat(n.join("|"),"|\n")}},{key:"log",value:function(){return this._log}}]),t}();function ge(t){return void 0!==t.ops}var be=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(){var t;(0,i.Z)(this,e);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(t=n.call.apply(n,[this].concat(a))).chip=new ct,t.clock=$.get(),t}return(0,r.Z)(e,[{key:"with",value:function(t){return this.chip=t,this}},{key:"hasVar",value:function(t){return"time"===t||(t="".concat(t),void 0!==this.chip.in(t)||void 0!==this.chip.out(t))}},{key:"getVar",value:function(t,n){if("time"===(t="".concat(t)))return this.clock.toString();var e=this.chip.get(t,n);return e?e instanceof Y?e.busVoltage:e.voltage():0}},{key:"setVar",value:function(t,n,e){var i=this.chip.get(t,e);i instanceof Y?i.busVoltage=n:null===i||void 0===i||i.pull(0===n?Q:X)}},{key:"eval",value:function(){this.chip.eval()}},{key:"tick",value:function(){this.chip.eval(),this.clock.tick()}},{key:"tock",value:function(){this.chip.eval(),this.clock.tock()}},{key:"load",value:function(){var t=(0,o.Z)((0,u.Z)().mark((function t(n){return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.chip.load(this.fs,n);case 2:case"end":return t.stop()}}),t,this)})));return function(n){return t.apply(this,arguments)}}()},{key:"run",value:function(){var t=(0,o.Z)((0,u.Z)().mark((function t(){return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.clock.reset(),t.next=3,(0,U.Z)((0,W.Z)(e.prototype),"run",this).call(this);case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}],[{key:"from",value:function(t){var n,i=new e,r=(0,x.Z)(t.lines);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(ge(a))i.addInstruction(e.makeLineStatement(a));else{var s=new we(a.count);i.addInstruction(s);var u,o=(0,x.Z)(a.statements);try{for(o.s();!(u=o.n()).done;){var c=u.value;s.addInstruction(e.makeLineStatement(c))}}catch(l){o.e(l)}finally{o.f()}}}}catch(l){r.e(l)}finally{r.f()}return i}},{key:"makeLineStatement",value:function(t){var n=new xe;n.span=t.span;var i,r=(0,x.Z)(t.ops);try{for(r.s();!(i=r.n()).done;){var a=i.value;n.addInstruction(e.makeInstruction(a))}}catch(s){r.e(s)}finally{r.f()}return n}},{key:"makeInstruction",value:function(t){var n=t.op;switch(n){case"tick":return new Me;case"tock":return new Pe;case"eval":return new Ae;case"output":return new ye;case"set":return new Ze(t.id,t.value,t.index);case"output-list":return new ke(t.spec);case"echo":return new je(t.message);case"clear-echo":return new Ce;case"load":return new Se(t.file);default:(0,z.qV)(n,"Unknown tst operation ".concat(n))}}}]),e}(me),Ze=function(){function t(n,e,r){(0,i.Z)(this,t),this.variable=n,this.value=e,this.index=r}return(0,r.Z)(t,[{key:"do",value:function(t){t.setVar(this.variable,this.value,this.index)}}]),t}(),ye=function(){function t(){(0,i.Z)(this,t)}return(0,r.Z)(t,[{key:"do",value:function(t){t.output()}}]),t}(),ke=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];(0,i.Z)(this,t),this.outputs=[];var e,r=(0,x.Z)(n);try{for(r.s();!(e=r.n()).done;){var a=e.value;this.addOutput(a)}}catch(s){r.e(s)}finally{r.f()}}return(0,r.Z)(t,[{key:"addOutput",value:function(t){this.outputs.push(new pe(t.id,t.style,t.width,t.lpad,t.rpad,t.builtin,t.address))}},{key:"do",value:function(t){t.outputList(this.outputs),t.header()}}]),t}(),xe=function(){function t(){(0,i.Z)(this,t),this.instructions=[],this.span=void 0}return(0,r.Z)(t,[{key:"addInstruction",value:function(t){this.instructions.push(t)}},{key:"do",value:function(){var t=(0,o.Z)((0,u.Z)().mark((function t(n){var e,i,r;return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=(0,x.Z)(this.instructions),t.prev=1,e.s();case 3:if((i=e.n()).done){t.next=9;break}return r=i.value,t.next=7,r.do(n);case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])})));return function(n){return t.apply(this,arguments)}}()}]),t}(),we=function(t){(0,a.Z)(e,t);var n=(0,s.Z)(e);function e(t){var r;return(0,i.Z)(this,e),(r=n.call(this)).repeat=t,r}return(0,r.Z)(e,[{key:"do",value:function(){var t=(0,o.Z)((0,u.Z)().mark((function t(n){var i;return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=0;case 1:if(!(i<this.repeat)){t.next=7;break}return t.next=4,(0,U.Z)((0,W.Z)(e.prototype),"do",this).call(this,n);case 4:i++,t.next=1;break;case 7:case"end":return t.stop()}}),t,this)})));return function(n){return t.apply(this,arguments)}}()}]),e}(xe),je=function(){function t(n){(0,i.Z)(this,t),this.content=n}return(0,r.Z)(t,[{key:"do",value:function(t){t.echo(this.content)}}]),t}(),Ce=function(){function t(){(0,i.Z)(this,t)}return(0,r.Z)(t,[{key:"do",value:function(t){t.clearEcho()}}]),t}(),Se=function(){function t(n){(0,i.Z)(this,t),this.file=n}return(0,r.Z)(t,[{key:"do",value:function(){var t=(0,o.Z)((0,u.Z)().mark((function t(n){return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.load(this.file);case 2:case"end":return t.stop()}}),t,this)})));return function(n){return t.apply(this,arguments)}}()}]),t}(),Ae=function(){function t(){(0,i.Z)(this,t),this._chipTestInstruction_=!0}return(0,r.Z)(t,[{key:"do",value:function(t){t.eval()}}]),t}(),Me=function(){function t(){(0,i.Z)(this,t),this._chipTestInstruction_=!0}return(0,r.Z)(t,[{key:"do",value:function(t){t.tick()}}]),t}(),Pe=function(){function t(){(0,i.Z)(this,t),this._chipTestInstruction_=!0}return(0,r.Z)(t,[{key:"do",value:function(t){t.tock()}}]),t}(),Ve=(0,h.createContext)(new fe.Wd(new fe.Cy)),De=e(2546);function Oe(t,n){return(0,h.useReducer)((function(n,e){return(0,De.ZP)(n,(function(n){t[e.action](n,e.payload)}))}),n)}var Ne=[["01",f.ag._("Project 1")],["02",f.ag._("Project 2")],["03",f.ag._("Project 3")],["05",f.ag._("Project 5")]],Re={"01":["Not","And","Or","XOr","Mux","DMux","Not16","And16","Or16","Mux16","Mux4Way16","Mux8Way16","DMux4Way","DMux8Way","Or8Way"],"02":["HalfAdder","FullAdder","Add16","Inc16","AluNoStat","ALU"],"03":["Bit","Register","PC","RAM8","RAM64","RAM512","RAM4k","RAM16k"],"05":["Memory","CPU","Computer"]};function Fe(t){return"CHIP ".concat(t," {\n    IN in;\n    OUT out;\n    PARTS:\n  }")}function Le(t){return{clocked:t.clocked,inPins:b(t.ins),outPins:b(t.outs),internalPins:b(t.pins),parts:new Set(t.parts)}}var Ee=$.get();function Te(t,n,e,i){var r=function(t){var n,e,i=null!==(n=t["/chip/project"])&&void 0!==n?n:"01",r=Re[i];return{project:i,chips:r,chipName:null!==(e=t["/chip/chip"])&&void 0!==e?e:r[0]}}(e),a=r.project,s=r.chips,l=r.chipName,h=new ct,d=new be,p=function(){var t={project:a,chips:s,chipName:l,hasBuiltin:le.has(l),runningTest:!1},e=he(t.chipName);(0,w.dZ)(e)?n((0,j.j)((0,w.UG)(e))):h=(0,w.Ok)(e);var i=Le(h);return setTimeout((function(){g.reloadChip()})),{controls:t,files:{hdl:"",cmp:"",tst:"",out:""},sim:i}}(),m={setFiles:function(t,n){var e=n.hdl,i=void 0===e?t.files.hdl:e,r=n.tst,a=void 0===r?t.files.tst:r,s=n.cmp,u=void 0===s?t.files.cmp:s,o=n.out,c=void 0===o?"":o;t.files.hdl=i,t.files.tst=a,t.files.cmp=u,t.files.out=c},updateChip:function(t){var n;t.sim=Le(h),t.controls.chips=Re[t.controls.project],t.controls.chipName=null!==(n=h.name)&&void 0!==n?n:l,t.controls.chips.includes(t.controls.chipName)||(t.controls.chips=[].concat((0,v.Z)(t.controls.chips),[t.controls.chipName]))},setProject:function(t,n){var e=Re[n],i=t.controls.chipName&&e.includes(t.controls.chipName)?t.controls.chipName:e[0];t.controls.project=n,t.controls.chips=e,this.setChip(t,i)},setChip:function(t,n){t.controls.chipName=n,t.controls.hasBuiltin=le.has(n)},testRunning:function(t){t.controls.runningTest=!0},testFinished:function(t){t.controls.runningTest=!1},updateTestStep:function(t){var n,e,i,r;t.files.out=null!==(n=null===(e=d)||void 0===e?void 0:e.log())&&void 0!==n?n:"",t.controls.span=null===(i=d)||void 0===i||null===(r=i.currentStep)||void 0===r?void 0:r.span,this.updateChip(t)}},g={setProject:function(t){a=e["/chip/project"]=t,i.current({action:"setProject",payload:a}),this.setChip(Re[a][0])},setChip:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e["/chip/project"];l=e["/chip/chip"]=t,i.current({action:"setChip",payload:l}),this.loadChip(n,l)},reset:function(){$.get().reset(),h.reset(),d.reset(),i.current({action:"setFiles",payload:{}}),i.current({action:"updateChip"})},updateFiles:function(t){var e=t.hdl,r=t.tst,a=t.cmp;i.current({action:"setFiles",payload:{hdl:e,tst:r,cmp:a}});try{this.compileChip(e),this.compileTest(r)}catch(s){n((0,j.j)(s))}},compileChip:function(t){h.remove();var e=R.parse(t);if((0,w.dZ)(e))return n("Failed to parse chip"),void i.current({action:"updateChip"});var r=ve((0,w.Ok)(e));if((0,w.dZ)(r))return n((0,j.j)((0,w.UG)(r))),void i.current({action:"updateChip"});n(f.ag._("Compiled {0}",{0:h.name})),this.replaceChip((0,w.Ok)(r))},replaceChip:function(t){var n,e=h.ins,r=(0,x.Z)(e);try{for(r.s();!(n=r.n()).done;){var a=(0,c.Z)(n.value,2),s=a[0],u=a[1].busVoltage;t.ins.has(s)&&(t.ins.get(s).busVoltage=u)}}catch(o){r.e(o)}finally{r.f()}t.eval(),h=t,i.current({action:"updateChip"})},loadChip:function(n,r){var a=this;return(0,o.Z)((0,u.Z)().mark((function s(){var o,l,h,d,v,f;return(0,u.Z)().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return e["/chip/chip"]=r,o=function(t){return"/projects/".concat(n,"/").concat(r,"/").concat(r,".").concat(t)},s.next=4,Promise.all([t.readFile(o("hdl")).catch((function(){return Fe(r)})),t.readFile(o("tst")).catch((function(){return"repeat 10 {\n      tick,\n      tock;\n    }"})),t.readFile(o("cmp")).catch((function(){return"| in|out|"}))]);case 4:l=s.sent,h=(0,c.Z)(l,3),d=h[0],v=h[1],f=h[2],i.current({action:"setFiles",payload:{hdl:d,tst:v,cmp:f}}),a.compileChip(d),a.compileTest(v);case 12:case"end":return s.stop()}}),s)})))()},saveChip:function(e){var r=arguments;return(0,o.Z)((0,u.Z)().mark((function s(){var o,c,h;return(0,u.Z)().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return o=r.length>1&&void 0!==r[1]?r[1]:a,c=r.length>2&&void 0!==r[2]?r[2]:l,i.current({action:"setFiles",payload:{hdl:e}}),h="/projects/".concat(o,"/").concat(c,"/").concat(c,".hdl"),s.next=6,t.writeFile(h,e);case 6:n("Saved ".concat(h));case 7:case"end":return s.stop()}}),s)})))()},toggle:function(t,n){void 0!==n?t.busVoltage=t.busVoltage^1<<n:1===t.width?t.toggle():t.busVoltage+=1,h.eval(),i.current({action:"updateChip"})},clock:function(){Ee.toggle(),i.current({action:"updateChip"})},useBuiltin:function(){var t=he(l);(0,w.dZ)(t)?n("Failed to load builtin ".concat(l,": ").concat((0,j.j)((0,w.UG)(t)))):this.replaceChip((0,w.Ok)(t))},reloadChip:function(){this.loadChip(a,l)},compileTest:function(e){i.current({action:"setFiles",payload:{tst:e}});var r=B.parse(e);return(0,w.dZ)(r)?(n(f.ag._("Failed to parse test")),!1):(n(f.ag._("Parsed tst")),(d=be.from((0,w.Ok)(r)).with(h)).setFileSystem(t),i.current({action:"updateTestStep"}),!0)},runTest:function(n){var e=this;return(0,o.Z)((0,u.Z)().mark((function r(){return(0,u.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e.compileTest(n)){r.next=2;break}return r.abrupt("return");case 2:return i.current({action:"testRunning"}),t.pushd("/samples"),r.next=6,d.run();case 6:t.popd(),i.current({action:"updateTestStep"});case 8:case"end":return r.stop()}}),r)})))()},tick:function(){return(0,o.Z)((0,u.Z)().mark((function t(){return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.step();case 2:case"end":return t.stop()}}),t)})))()}};return{initialState:p,reducers:m,actions:g}}var Ie="Cmp <: Base {\n  Root := line*\n  line = bar cell+ newline?\n  cell = cellvalue bar\n  cellvalue = (~(bar|newline) any)*\n}",Be=C.Z.grammar(Ie,M),_e=Be.extendSemantics(P);_e.addAttribute("cell",{cell:function(t,n){return t.sourceString}}),_e.addAttribute("line",{line:function(t,n,e){return n.children.map((function(t){return t.cell}))}}),_e.addAttribute("root",{Root:function(t){return t.children.map((function(t){return t.line}))}});var Ue={grammar:Ie,semantics:_e,parser:Be,parse:V(Be,_e)},We=function(t){var n=t.className,e=void 0===n?"":n,i=t.out,r=t.cmp,a=Ue.parse(i),s=Ue.parse(r);if((0,w.dZ)(a))return(0,m.jsxs)("details",{children:[(0,m.jsx)("summary",{children:(0,m.jsx)(l.cC,{id:"Failed to parse output"})}),(0,m.jsx)("pre",{children:(0,j.j)((0,w.UG)(a))}),(0,m.jsx)("code",{children:(0,m.jsx)("pre",{children:i})})]});if((0,w.dZ)(s))return(0,m.jsxs)("details",{children:[(0,m.jsx)("summary",{children:(0,m.jsx)(l.cC,{id:"Failed to parse compare"})}),(0,m.jsxs)("code",{children:[(0,m.jsx)("pre",{children:(0,j.j)((0,w.UG)(s))}),(0,m.jsx)("pre",{children:r})]})]});var u=(0,w.Ok)(s),o=(0,w.Ok)(a),h=0,d=(0,p.w)(0,Math.max(u.length,o.length)).map((function(t){var n,e,i=null!==(n=u[t])&&void 0!==n?n:[],r=null!==(e=o[t])&&void 0!==e?e:[];return(0,p.w)(0,Math.max(i.length,r.length)).map((function(t,n){var e,a;return[null!==(e=i[n])&&void 0!==e?e:"",null!==(a=r[n])&&void 0!==a?a:""]})).map((function(t){var n=(0,c.Z)(t,2),e=n[0],i=n[1],r={cmp:null!==e&&void 0!==e?e:'"',out:null!==i&&void 0!==i?i:'"',pass:null!==(null===e||void 0===e?void 0:e.trim().match(/^\*+$/))||(null===i||void 0===i?void 0:i.trim())===(null===e||void 0===e?void 0:e.trim())};return r.pass||(h+=1),r}))}));return(0,m.jsxs)("div",{className:"scroll-x "+e,children:[(0,m.jsx)("p",{children:(0,m.jsx)(l.cC,{id:"{failures, plural, one {{failures} failure} other {{failures} failures}}",values:{failures:h}})}),(0,m.jsx)("table",{style:{fontFamily:"var(--font-family-monospace)",marginBottom:"none"},children:(0,m.jsx)("tbody",{children:d.map((function(t,n){return(0,m.jsx)("tr",{children:t.map((function(t,n){var e=t.cmp,i=t.out,r=t.pass;return(0,m.jsx)(He,{cmp:e,out:i,pass:r},n)}))},n)}))})})]})},He=function(t){var n=t.cmp,e=t.out;return t.pass?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("td",{children:n}),(0,m.jsx)("td",{})]}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("td",{children:(0,m.jsx)("ins",{children:n})}),(0,m.jsx)("td",{children:(0,m.jsx)("del",{children:e})})]})},Je=e(6683),Ke=e(5415),ze=e(1438),Ge=function(t){var n,e,i=t.error;return null!==i&&void 0!==i&&i.failed()?(0,m.jsxs)("details",{className:"ErrorPanel",open:!0,children:[(0,m.jsx)("summary",{role:"button",className:"secondary",children:(0,m.jsx)(l.cC,{id:"Parse Error"})}),(0,m.jsx)("pre",{children:(0,m.jsx)("code",{children:null!==(n=null!==(e=null===i||void 0===i?void 0:i.message)&&void 0!==e?e:null===i||void 0===i?void 0:i.shortMessage)&&void 0!==n?n:A})})]}):(0,m.jsx)(m.Fragment,{})},qe=function(t){var n=t.value,e=t.onChange,i=t.language,r=t.disabled,a=void 0!==r&&r,s=(0,h.useState)(n),u=(0,c.Z)(s,2),o=u[0],l=u[1];return(0,m.jsx)("textarea",{"data-testid":"editor-".concat(i),disabled:a,value:o,onChange:function(t){var n,i=null===(n=t.target)||void 0===n?void 0:n.value;l(i),e(i)}})},$e=function(t){var n=t.value,e=t.onChange,i=t.language,r=t.error,a=t.disabled,s=void 0!==a&&a,u=t.highlight,o=(0,h.useContext)(wn.Il).theme,c=(0,Ke.Ik)(),l=(0,h.useRef)(),d=(0,h.useRef)([]),v=(0,h.useCallback)((function(t){var n;l.current=t,null===(n=l.current)||void 0===n||n.updateOptions({fontFamily:'"JetBrains Mono", source-code-pro, Menlo, Monaco,\n      Consolas, "Roboto Mono", "Ubuntu Monospace", "Noto Mono", "Oxygen Mono",\n      "Liberation Mono", monospace, "Apple Color Emoji", "Segoe UI Emoji",\n      "Segoe UI Symbol", "Noto Color Emoji"',fontSize:16,minimap:{enabled:!1}})}),[]);return(0,h.useEffect)((function(){if(l.current){var t=l.current.getModel(),n=[];if(t&&u){var e=t.getPositionAt(u.start),i=t.getPositionAt(u.end),r=null===c||void 0===c?void 0:c.Range.fromPositions(e,i);r&&(n.push({range:r,options:{inlineClassName:"highlight"}}),l.current.revealRangeInCenter(r))}d.current=l.current.deltaDecorations(d.current,n)}}),[l,u,c]),(0,h.useEffect)((function(){var t,n="system"===o?window.matchMedia("prefers-color-scheme: dark").matches:"dark"===o;null===(t=l.current)||void 0===t||t.updateOptions({theme:n?"vs-dark":"vs"})}),[l,o]),(0,h.useEffect)((function(){void 0!==l.current&&l.current.updateOptions({readOnly:s})}),[l,s]),(0,h.useEffect)((function(){var t,n,e,a,s;if(void 0!==l.current&&null!==c){var u=l.current.getModel();if(null!==u)if(void 0===r||r.succeeded())c.editor.setModelMarkers(u,i,[]);else{var o=null!==(t=null===(n=(0,K.Z)(/Line (\d+), col (\d+): (.*)/,{line:1,column:2,message:3}).exec(null!==(e=r.shortMessage)&&void 0!==e?e:""))||void 0===n?void 0:n.groups)&&void 0!==t?t:{line:1,column:1,message:"could not parse error"},h=o.line,d=o.column,v=o.message,f=Number(h),p=f,m=Number(d),g=m+(null!==(a=null===(s=u.getLineContent(f).substring(m-1).match(/([^\s]+)/))||void 0===s?void 0:s[0].length)&&void 0!==a?a:1);g<=m&&(g=m+1),c.editor.setModelMarkers(u,i,[{message:v,startColumn:m,startLineNumber:f,endColumn:g,endLineNumber:p,severity:ze.ZL.Error}])}}}),[r,l,c,i]),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(Ke.ZP,{value:n,onChange:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e(t)},language:i,onMount:v}),s&&(0,m.jsx)("div",{className:"overlay"})]})},Xe=function(t){var n=t.className,e=void 0===n?"":n,i=t.style,r=void 0===i?{}:i,a=t.disabled,s=void 0!==a&&a,u=t.value,o=t.onChange,l=t.grammar,d=t.language,v=t.highlight,f=(0,h.useState)(),p=(0,c.Z)(f,2),g=p[0],b=p[1],Z=(0,h.useContext)(wn.Il).monaco,y=(0,h.useCallback)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=l.match(t);b(n.failed()?n:void 0)}),[b,l]);(0,h.useEffect)((function(){return y(u)}),[y,u]);var k=(0,h.useMemo)((function(){return(0,Je.D)(y,500)}),[y]),x=(0,h.useCallback)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";o(t),k(t)}),[k,o]);return(0,m.jsx)("div",{className:"Editor ".concat(e),style:r,children:Z.canUse&&Z.wants?(0,m.jsx)($e,{value:u,onChange:x,language:d,error:g,disabled:s,highlight:v}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(qe,{value:u,onChange:x,language:d,disabled:s}),(0,m.jsx)(Ge,{error:g})]})})},Qe=$.get(),Ye=function(){var t=(0,h.useState)((0,j.j)(Qe)),n=(0,c.Z)(t,2),e=n[0],i=n[1];return(0,h.useEffect)((function(){var t=Qe.$.subscribe((function(){i((0,j.j)(Qe))}));return function(){return t.unsubscribe()}})),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(l.cC,{id:"Clock:"})," ",(0,j.j)(e)]})},ti=function(t){var n=t.parts,e=(0,v.Z)(n).flatMap((function(t){return t.render().map((function(n,e){return["".concat(t.id,"_").concat(e),n]}))}));return 0===e.length?(0,m.jsx)(l.cC,{id:"None"}):(0,m.jsx)(m.Fragment,{children:e.map((function(t){var n=(0,c.Z)(t,2),e=n[0],i=n[1];return(0,m.jsx)("div",{children:i},e)}))})},ni=(0,J.Z)("running"),ei=(0,J.Z)("sinceLastFrame"),ii=(0,J.Z)("lastUpdate"),ri=(0,J.Z)("run"),ai=function(){function t(){var n=this;(0,i.Z)(this,t),this.steps=1,this.speed=1e3,Object.defineProperty(this,ni,{writable:!0,value:!1}),Object.defineProperty(this,ei,{writable:!0,value:0}),Object.defineProperty(this,ii,{writable:!0,value:0}),Object.defineProperty(this,ri,{writable:!0,value:function(){if((0,H.Z)(n,ni)[ni]){var t=Date.now(),e=t-(0,H.Z)(n,ii)[ii];if((0,H.Z)(n,ii)[ii]=t,(0,H.Z)(n,ei)[ei]+=e,(0,H.Z)(n,ei)[ei]>n.speed){for(var i=0;i<Math.min(n.steps,1e3);i++)n.tick();n.finishFrame(),(0,H.Z)(n,ei)[ei]-=n.speed}requestAnimationFrame((0,H.Z)(n,ri)[ri])}}})}return(0,r.Z)(t,[{key:"frame",value:function(){this.tick(),this.finishFrame()}},{key:"running",get:function(){return(0,H.Z)(this,ni)[ni]}},{key:"start",value:function(){(0,H.Z)(this,ni)[ni]=!0,(0,H.Z)(this,ii)[ii]=Date.now()-this.speed,(0,H.Z)(this,ri)[ri](),this.toggle()}},{key:"stop",value:function(){(0,H.Z)(this,ni)[ni]=!1,this.toggle()}}]),t}();var si=function(t){var n=function(t){var n=(0,h.useRef)((function(){})),e=(0,h.useMemo)((function(){return function(t,n){var e={running:t.running,speed:t.speed,steps:t.steps},i=t.finishFrame.bind(t);return t.finishFrame=function(){i(),n.current({action:"update"})},{initialState:e,reducers:{update:function(n){n.running=t.running,n.speed=t.speed,n.steps=t.steps},setSteps:function(t,n){t.steps=n},setSpeed:function(t,n){t.speed=n}},actions:{frame:function(){t.frame()},start:function(){t.start(),n.current({action:"update"})},stop:function(){t.stop(),n.current({action:"update"})},reset:function(){t.reset(),n.current({action:"update"})}}}}(t,n)}),[t,n]),i=e.initialState,r=e.reducers,a=e.actions,s=Oe(r,i),u=(0,c.Z)(s,2),o=u[0],l=u[1];return n.current=l,{state:o,dispatch:n.current,actions:a}}(t.runner);return(0,m.jsxs)("fieldset",{role:"group",children:[(0,m.jsx)("button",{className:"flex-0",onClick:function(){return n.actions.frame()},"data-tooltip":f.ag._("Next"),children:(0,m.jsx)(xn.J,{name:"skip_next"})}),(0,m.jsx)("button",{className:"flex-0",onClick:function(){return n.actions.reset()},"data-tooltip":f.ag._("Reset"),children:(0,m.jsx)(xn.J,{name:"first_page"})}),(0,m.jsx)("button",{className:"flex-0",onClick:function(){return n.state.running?n.actions.stop():n.actions.start()},"data-tooltip":n.state.running?f.ag._("Stop"):f.ag._("Run"),children:(0,m.jsx)(xn.J,{name:n.state.running?"pause":"play_arrow"})}),(0,m.jsx)("select",{className:"flex-1",name:"speed",value:n.state.speed,onChange:function(t){var e,i;n.dispatch({action:"setSpeed",payload:Number(null!==(e=null===(i=t.target)||void 0===i?void 0:i.value)&&void 0!==e?e:n.state.speed)})},disabled:n.state.running,children:[[16,f.ag._("60FPS")],[500,f.ag._("Fast")],[1e3,f.ag._("Normal")],[2e3,f.ag._("Slow")]].map((function(t){var n=(0,c.Z)(t,2),e=n[0],i=n[1];return(0,m.jsx)("option",{value:e,children:i},e)}))}),(0,m.jsx)("select",{className:"flex-1",name:"steps",value:n.state.steps,onChange:function(t){var e,i;n.dispatch({action:"setSteps",payload:Number(null!==(e=null===(i=t.target)||void 0===i?void 0:i.value)&&void 0!==e?e:n.state.steps)})},disabled:n.state.running,children:[[1,f.ag._("1 Step")],[500,"500"],[1e3,"1000"],[2e3,"2000"]].map((function(t){var n=(0,c.Z)(t,2),e=n[0],i=n[1];return(0,m.jsx)("option",{value:e,children:i},e)}))}),t.children]})};function ui(t){var n=(0,h.useState)(t),e=(0,c.Z)(n,2),i=e[0],r=e[1];return(0,h.useEffect)((function(){r(t)}),[t]),[i,r]}var oi=function(){var t=function(){var t=(0,h.useContext)(Ve),n=(0,h.useContext)(wn.Il).setStatus,e=(0,h.useMemo)((function(){return localStorage}),[]),i=(0,h.useRef)((function(){})),r=(0,h.useMemo)((function(){return Te(t,n,e,i)}),[t,n,e,i]),a=r.initialState,s=r.reducers,u=r.actions,o=Oe(s,a),l=(0,c.Z)(o,2),d=l[0],v=l[1];return i.current=v,{state:d,dispatch:i,actions:u}}(),n=t.state,e=t.actions,d=t.dispatch,v=ui(n.files.hdl),f=(0,c.Z)(v,2),p=f[0],g=f[1],b=ui(n.files.tst),y=(0,c.Z)(b,2),k=y[0],x=y[1],w=ui(n.files.cmp),j=(0,c.Z)(w,2),C=j[0],S=j[1],A=ui(n.files.out),M=(0,c.Z)(A,1)[0],P=(0,h.useRef)();P.current=(0,o.Z)((0,u.Z)().mark((function t(){return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.updateFiles({hdl:p,tst:k,cmp:C});case 2:case"end":return t.stop()}}),t)})));var V=(0,h.useRef)();(0,h.useEffect)((function(){return V.current=new(function(t){(0,a.Z)(c,t);var n=(0,s.Z)(c);function c(){return(0,i.Z)(this,c),n.apply(this,arguments)}return(0,r.Z)(c,[{key:"reset",value:function(){var t=(0,o.Z)((0,u.Z)().mark((function t(){var n;return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(n=P.current)||void 0===n?void 0:n.call(P);case 2:return t.next=4,e.reset();case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"finishFrame",value:function(){d.current({action:"updateTestStep"})}},{key:"tick",value:function(){var t=(0,o.Z)((0,u.Z)().mark((function t(){return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.tick();case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"toggle",value:function(){d.current({action:"updateTestStep"})}}]),c}(ai)),function(){var t;null===(t=V.current)||void 0===t||t.stop()}}),[P,e,d]);var D=(0,h.useState)(!1),O=(0,c.Z)(D,2),N=O[0],F=O[1],L=function(){var t=(0,o.Z)((0,u.Z)().mark((function t(){var n;return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:N?(null===(n=P.current)||void 0===n||n.call(P),F(!1)):(e.useBuiltin(),F(!0));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),E=(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{children:(0,m.jsx)(l.cC,{id:"Chip"})}),(0,m.jsxs)("fieldset",{role:"group",children:[(0,m.jsx)("select",{value:n.controls.project,onChange:function(t){var n=t.target.value;e.setProject(n)},"data-testid":"project-picker",children:Ne.map((function(t){var n=(0,c.Z)(t,2),e=n[0],i=n[1];return(0,m.jsx)("option",{value:e,children:i},e)}))}),(0,m.jsx)("select",{value:n.controls.chipName,onChange:function(t){var n=t.target.value;e.setChip(n)},"data-testid":"chip-picker",children:n.controls.chips.map((function(t){return(0,m.jsx)("option",{value:t,children:t},t)}))})]})]}),T=(0,m.jsx)(Rn,{className:"_hdl_panel",header:(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{tabIndex:0,children:"HDL"}),(0,m.jsx)("fieldset",{children:n.controls.hasBuiltin&&(0,m.jsxs)("label",{children:[(0,m.jsx)("input",{type:"checkbox",role:"switch",checked:N,onChange:L}),(0,m.jsx)(l.cC,{id:"Builtin"})]})}),(0,m.jsxs)("fieldset",{role:"group",children:[(0,m.jsx)("button",{onClick:P.current,onKeyDown:P.current,disabled:N,children:(0,m.jsx)(l.cC,{id:"Eval"})}),(0,m.jsx)("button",{onClick:function(){e.saveChip(p)},disabled:N,children:(0,m.jsx)(l.cC,{id:"Save"})}),(0,m.jsx)("button",{style:{whiteSpace:"nowrap"},onClick:function(){e.clock()},disabled:!n.sim.clocked,"data-testid":"clock",children:(0,m.jsx)(Ye,{})}),(0,m.jsx)("button",{onClick:function(){e.reset()},disabled:!n.sim.clocked,"data-testid":"clock-reset",children:(0,m.jsx)(l.cC,{id:"Reset"})})]})]}),children:(0,m.jsx)(Xe,{className:"flex-1",value:p,onChange:g,grammar:R.parser,language:"hdl",disabled:N})}),I=(0,m.jsxs)(Rn,{className:"_parts_panel",header:E,children:[(0,m.jsx)(Z,{ins:{pins:n.sim.inPins,toggle:function(t,n){e.toggle(t,n)}},outs:{pins:n.sim.outPins},internal:{pins:n.sim.internalPins}}),(0,m.jsx)(Fn,{summary:(0,m.jsx)(l.cC,{id:"Visualizations"}),children:(0,m.jsx)("main",{children:(0,m.jsx)(ti,{parts:n.sim.parts})})})]}),_=(0,m.jsxs)(Rn,{className:"_test_panel",children:[(0,m.jsx)(Fn,{summary:(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"flex-1",children:(0,m.jsx)(l.cC,{id:"Test"})}),(0,m.jsx)("div",{className:"flex-2",children:V.current&&(0,m.jsx)(si,{runner:V.current})})]}),style:{position:"relative"},children:(0,m.jsx)(Xe,{style:{position:"absolute",height:"calc(100% - var(--line-height) * var(--font-size) * 2)"},value:k,onChange:x,grammar:B.parser,language:"tst",highlight:n.controls.span})}),(0,m.jsx)(Fn,{summary:(0,m.jsx)(l.cC,{id:"Comparison"}),style:{position:"relative"},children:(0,m.jsx)(Xe,{style:{position:"absolute",height:"calc(100% - var(--line-height) * var(--font-size) * 2)"},value:C,onChange:S,grammar:Ue.parser,language:"cmp"})}),(0,m.jsx)(Fn,{summary:(0,m.jsx)(l.cC,{id:"Diff"}),open:!0,children:(0,m.jsx)("div",{style:{paddingLeft:"var(--block-spacing-horizontal)"},children:(0,m.jsx)(We,{cmp:C,out:M})})})]});return(0,m.jsxs)("div",{className:"ChipPage grid",children:[T,I,_]})},ci=oi},5782:function(t,n,e){e.d(n,{Bb:function(){return u},PH:function(){return i},Uc:function(){return r},lK:function(){return a},vU:function(){return s}});var i={asm:{0:42,1:63,"-1":58,D:12,A:48,M:48,"!D":13,"!A":49,"-D":15,"-A":51,"D+1":31,"A+1":55,"D-1":14,"A-1":50,"D+A":2,"D-A":19,"D-M":19,"A-D":7,"D&A":0,"D&M":0,"D|A":21,"D|M":21},op:{42:"0",63:"1",58:"-1",12:"D",48:"A",13:"!D",49:"!A",15:"-D",51:"-A",31:"D+1",55:"A+1",14:"D-1",50:"A-1",2:"D+A",19:"D-A",7:"A-D",0:"D&A",21:"D|A"}},r={asm:{"":0,M:1,D:2,MD:3,A:4,AM:5,AD:6,AMD:7},op:{0:"",1:"M",2:"D",3:"MD",4:"A",5:"AM",6:"AD",7:"AMD"}},a={asm:{"":0,JGT:1,JEQ:2,JGE:3,JLT:4,JNE:5,JLE:6,JMP:7},op:{0:"",1:"JGT",2:"JEQ",3:"JGE",4:"JLT",5:"JNE",6:"JLE",7:"JMP"}},s={1:"Positive",0:"Zero",15:"Negative",Positive:1,Zero:0,Negative:15};function u(t,n,e){var i=0;switch(t){case 42:i=0;break;case 63:i=1;break;case 58:i=-1;break;case 12:i=n;break;case 48:i=e;break;case 13:i=~n;break;case 49:i=~e;break;case 15:i=-n;break;case 51:i=-e;break;case 31:i=n+1;break;case 55:i=e+1;break;case 14:i=n-1;break;case 50:i=e-1;break;case 2:i=n+e;break;case 19:i=n-e;break;case 7:i=e-n;break;case 0:i=n&e;break;case 21:i=n|e}return[i&=65535,0===i?s.Zero:32768&i?s.Negative:s.Positive]}},1291:function(t,n,e){e.d(n,{a:function(){return a},op:function(){return s},p:function(){return u}});var i=e(804),r=e(5782);function a(t){return 32768&t?function(t){var n=(4096&(t&=65535))>>12,e=(4032&t)>>6,i=(56&t)>>3,a=7&t;if(void 0===r.PH.op[e])return"#ERR";var s=r.PH.op[e];n&&(s=s.replace(/A/g,"M"));var u=r.Uc.op[i],o=r.lK.op[a],c=s;u&&(c="".concat(u,"=").concat(c));o&&(c="".concat(c,";").concat(o));return c}(t):function(t){return"@"+(32767&t).toString(10)}(t)}function s(t){return"@"===t[0]?function(t){return parseInt(t.substring(1),10)}(t):function(t){var n,e,a,s,o=t.match((0,i.Z)(/(?:([AMD]{1,3})=)?([-!01ADM&|]{1,3})(?:;(JGT|JLT|JGE|JLE|JEQ|JMP))?/,{assign:1,operation:2,jump:3})),c=null!==(n=null===o||void 0===o?void 0:o.groups)&&void 0!==n?n:{},l=c.assign,h=c.operation,d=c.jump,v=h.includes("M")||l.includes("M"),f=r.Uc.asm[null!==(e=l)&&void 0!==e?e:""],p=r.lK.asm[null!==(a=d)&&void 0!==a?a:""],m=r.PH.asm[null!==(s=h)&&void 0!==s?s:""];return u(v,m,f,p)}(t)}function u(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=57344,a=t?4096:0,s=n<<6,u=(null!==e&&void 0!==e?e:0)<<3,o=null!==i&&void 0!==i?i:0;return r+a+s+u+o}},6509:function(t,n,e){e.d(n,{$v:function(){return l},Af:function(){return u},C$:function(){return c},C2:function(){return f},E_:function(){return d},Ly:function(){return h},nN:function(){return v},o5:function(){return o}});var i=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"];function r(t){var n;return null!==(n=i[t])&&void 0!==n?n:"X"}function a(t){switch(t){case 0:return"0000";case 1:return"0001";case 2:return"0010";case 3:return"0011";case 4:return"0100";case 5:return"0101";case 6:return"0110";case 7:return"0111";case 8:return"1000";case 9:return"1001";case 10:return"1010";case 11:return"1011";case 12:return"1100";case 13:return"1101";case 14:return"1110";case 15:return"1111";default:return"erro"}}function s(t,n){return 65535&parseInt(t.replace(/[^\d+-.xa-fA-F]/g,""),n)}function u(t){return s(t,16)}function o(t){return s(t,10)}function c(t){return s(t,2)}function l(t){var n=r((61440&t)>>12),e=r((3840&t)>>8),i=r((240&t)>>4),a=r(15&t);return"0x".concat(n).concat(e).concat(i).concat(a)}function h(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,e=a((61440&t)>>12),i=a((3840&t)>>8),r=a((240&t)>>4),s=a(15&t);return"".concat(e).concat(i).concat(r).concat(s).substring(16-n)}function d(t){return 32768===(t&=65535)?"-32768":32768&t?"-".concat(t=1+~t&32767):"".concat(t)}function v(t){return"".concat(t&=65535)}function f(t,n){var e=~((t&=65535)&(n&=65535));return e&=65535}}}]);
//# sourceMappingURL=1.e7600b6e.chunk.js.map